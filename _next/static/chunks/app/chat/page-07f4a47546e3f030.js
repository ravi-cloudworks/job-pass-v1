(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{62852:function(e,t,s){Promise.resolve().then(s.bind(s,37736))},37736:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return em}});var n,r=s(2403),a=s(5194),i=s(1780),l=s(50059),o=s(85735),c=s(5853),d=s(57437),u=s(2265),m=s(12249),f=s(62869),x=s(46796),h=s(43643),p=s(94508),v=u.forwardRef(function(e,t){var s=e.className,n=e.children,r=(0,x._)(e,["className","children"]);return(0,d.jsxs)(h.fC,(0,i._)((0,a._)({ref:t,className:(0,p.cn)("relative overflow-hidden",s)},r),{children:[(0,d.jsx)(h.l_,{className:"h-full w-full rounded-[inherit]",children:n}),(0,d.jsx)(g,{}),(0,d.jsx)(h.Ns,{})]}))});v.displayName=h.fC.displayName;var g=u.forwardRef(function(e,t){var s=e.className,n=e.orientation,r=void 0===n?"vertical":n,l=(0,x._)(e,["className","orientation"]);return(0,d.jsx)(h.gb,(0,i._)((0,a._)({ref:t,orientation:r,className:(0,p.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s)},l),{children:(0,d.jsx)(h.q4,{className:"relative flex-1 rounded-full bg-border"})}))});g.displayName=h.gb.displayName;var y=s(16831),b=s(91723),N=s(82222),j=s(92369),w=s(65613),_=s(24593),C=s(37099),k=s(48614),S=s(40521),T=s(66070),E=s(26815),I=s(95186),U={Easy:15,Medium:30,Advanced:45},R=(n=(0,r._)(function(e){return(0,c.Jh)(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e){return setTimeout(e,1e3)})];case 1:return e.sent(),[2,!0]}})}),function(e){return n.apply(this,arguments)});function D(e){var t=e.text,s=e.messageIndex,n=e.onComplete,r=(0,l._)((0,u.useState)(""),2),a=r[0],i=r[1],o=(0,l._)((0,u.useState)(!1),2),c=o[0],m=o[1],f=(0,u.useRef)(null);return(0,u.useEffect)(function(){return f.current&&clearTimeout(f.current),i(""),m(!1),f.current=setTimeout(function(){var e="",r=function(a){if(a>=t.length){m(!0),setTimeout(function(){n(s,t)},300);return}i(e+=t.charAt(a)),f.current=setTimeout(function(){return r(a+1)},20)};r(0)},50),function(){f.current&&clearTimeout(f.current)}},[t,s,n]),(0,d.jsxs)(d.Fragment,{children:[a,!c&&(0,d.jsx)("span",{className:"inline-block w-1.5 h-4 ml-0.5 align-[-0.1em] bg-current opacity-70 animate-pulse",children:"|"})]})}function Y(e){var t,s,n,x,h=e.onSendMessage,p=e.onGenerateImage,g=(0,l._)((0,u.useState)([]),2),Y=g[0],z=g[1],M=(0,l._)((0,u.useState)((0,_.Mk)("root")),2),A=M[0],P=M[1],V=(0,l._)((0,u.useState)(!1),2),q=V[0],F=V[1],L=(0,l._)((0,u.useState)(15),2),G=L[0],O=L[1],J=(0,l._)((0,u.useState)(null),2),H=(J[0],J[1]),B=(0,l._)((0,u.useState)(!1),2),X=B[0],$=B[1],W=(0,l._)((0,u.useState)(null),2),Q=W[0],K=W[1],ee=(0,u.useRef)(null),et=(0,l._)((0,u.useState)(!1),2),es=et[0],en=et[1],er=(0,l._)((0,u.useState)(""),2),ea=er[0],ei=er[1],el=(0,l._)((0,u.useState)({}),2),eo=el[0],ec=el[1],ed=(0,l._)((0,u.useState)(!1),2),eu=ed[0],em=ed[1],ef=(0,l._)((0,u.useState)(null),2),ex=ef[0],eh=ef[1],ep=(0,l._)((0,u.useState)(!1),2),ev=ep[0],eg=ep[1],ey=(0,u.useCallback)(function(e,t){ec(function(s){return(0,i._)((0,a._)({},s),(0,m._)({},e,t))})},[]);(0,u.useEffect)(function(){var e=(0,_.Mk)("root");z([{role:"ai",content:e.question,options:(0,o._)(e.options||[])}]),console.log("Chat history reset with new flow data")},[_.EC]),(0,u.useEffect)(function(){var e=A===(0,_.Mk)("root");z([{role:"ai",content:A.question,options:e?(0,o._)(A.options||[]):(0,o._)(A.options||[]).concat(["start_over"])}])},[A]);var eb=function(){var e;null===(e=ee.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},eN=(0,u.useRef)(!0);console.log("\uD83D\uDCE2 Chat component is mounting"),(0,u.useEffect)(function(){var e=setTimeout(function(){!eu&&eN.current&&(console.log("⚠️ Failsafe: Setting flow ready after timeout"),em(!0))},5e3);return function(){return clearTimeout(e)}},[eu]),(0,u.useEffect)(function(){console.log("\uD83C\uDFA7 Setting up event listeners for flow");var e=function(e){console.log("✅ Received company-flow-ready event"),em(!0)},t=function(e){eN.current&&(console.log("❌ Received company-flow-error event:",e.detail.error),eh(e.detail.error),em(!0))},s=(0,_.u1)();return console.log('\uD83D\uDD0D Chat component checking company_id: "'.concat(s,'"')),window.addEventListener("company-flow-ready",e),window.addEventListener("company-flow-error",t),s&&!((null===_.lh||void 0===_.lh?void 0:_.lh.companies)&&s in _.lh.companies)?(console.log('❌ Invalid company ID in Chat component: "'.concat(s,'"')),eh('Invalid company ID: "'.concat(s,'"')),em(!0)):s?(console.log('✓ Valid company ID found: "'.concat(s,'", waiting for flow ready event')),setTimeout(function(){if(!eu&&eN.current){var e,t;console.log("⏱️ Checking flow status after delay..."),_.EC&&(null===(e=_.EC.metadata)||void 0===e?void 0:e.company)===(null===(t=_.lh.companies[s])||void 0===t?void 0:t.name)&&(console.log("✅ Company flow already loaded, setting ready state"),em(!0))}},1e3)):(console.log("ℹ️ No company ID, proceeding with default flow"),_.EC&&_.EC.nodes&&_.EC.nodes.root&&(console.log("✅ Default flow already initialized, setting ready"),em(!0))),function(){console.log("\uD83E\uDDF9 Cleaning up event listeners"),eN.current=!1,window.removeEventListener("company-flow-ready",e),window.removeEventListener("company-flow-error",t)}},[]),(0,u.useEffect)(function(){eb()},[Y,eo]);var ej=(t=(0,r._)(function(e){var t,s,n;return(0,c.Jh)(this,function(r){return"start_over"===e?(P((0,_.Mk)("root")),z([{role:"ai",content:(0,_.Mk)("root").question,options:(0,o._)((0,_.Mk)("root").options||[])}]),H(null),ec({}),setTimeout(function(){ey(0,(0,_.Mk)("root").question)},100)):(t={role:"user",content:(0,_.GJ)(e)},z(function(e){return(0,o._)(e).concat([t])}),F(!0),h(e),P(s=(0,_.Mk)(e)),n={role:"ai",content:s.question,options:(0,o._)(s.options||[]).concat(["start_over"])},z(function(e){return(0,o._)(e).concat([n])}),F(!1)),[2]})}),function(e){return t.apply(this,arguments)}),ew=function(e){if(!ev){if(G<U[e]){var t={role:"ai",type:"payment-options",content:"Insufficient minutes remaining. Please choose a payment option:",options:["use_prepaid_code"]};z(function(e){return(0,o._)(e).concat([t])}),K(e);return}K(e),eg(!0),$(!0)}},e_=(s=(0,r._)(function(e){return(0,c.Jh)(this,function(t){return"use_prepaid_code"===e&&en(!0),[2]})}),function(e){return s.apply(this,arguments)}),eC=(n=(0,r._)(function(e){var t,s,n,r,a,i,l,d,u;return(0,c.Jh)(this,function(c){switch(c.label){case 0:if($(!1),!e||!Q)return eg(!1),[2];t=U[Q],s={role:"user",content:Q},z(function(e){return(0,o._)(e).concat([s])}),O(function(e){return e-t}),H(Q),F(!0),c.label=1;case 1:if(c.trys.push([1,4,,5]),!(n=(0,_.PD)(A,Q)))throw Error("No valid question set found for the selected complexity");for(r=A.text||"",a=A.parent;a;)(i=(0,_.Mk)(a)).text&&(r="".concat(i.text," > ").concat(r)),a=i.parent;return l="".concat(r," - ").concat(Q),[4,new Promise(function(e){return setTimeout(e,4e4)})];case 2:return c.sent(),[4,p(l,n,Q,r)];case 3:return c.sent(),F(!1),eg(!1),d={role:"ai",type:"image-generation",content:"Your AI interview for ".concat(r," with ").concat(Q,' complexity has been generated successfully! You can find "New" in Assessment Vault.'),options:["start_over"],questionSetId:n,complexity:Q,category:r},z(function(e){return(0,o._)(e).concat([d])}),[3,5];case 4:return console.error("Error in handleComplexitySelection:",c.sent()),F(!1),u={role:"ai",content:"I'm sorry, there was an error generating AI Interview. Please try again.",options:["start_over"]},z(function(e){return(0,o._)(e).concat([u])}),eg(!1),[3,5];case 5:return[2]}})}),function(e){return n.apply(this,arguments)}),ek=(x=(0,r._)(function(){var e,t,s;return(0,c.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,R(ea)];case 1:return n.sent()?(en(!1),ei(""),O(e=G+30),Q&&(e>=U[Q]?(K(Q),$(!0)):(t={role:"ai",type:"payment-options",content:"Insufficient minutes remaining. Please choose a payment option:",options:["use_prepaid_code"]},z(function(e){return(0,o._)(e).concat([t])})))):(s={role:"ai",content:"Invalid prepaid code. Please try again.",options:["use_prepaid_code"]},z(function(e){return(0,o._)(e).concat([s])})),[3,3];case 2:return console.error("Error validating prepaid code:",n.sent()),[3,3];case 3:return[2]}})}),function(){return x.apply(this,arguments)}),eS=function(e){return e.map(function(e,t){return(0,d.jsx)(f.z,{variant:"use_prepaid_code"===e?"default":"secondary",size:"sm",disabled:ev&&("Easy"===e||"Medium"===e||"Advanced"===e||"start_over"===e),className:"w-full text-left justify-start text-xs \n    ".concat(ev&&("Easy"===e||"Medium"===e||"Advanced"===e||"start_over"===e)?"opacity-50 cursor-not-allowed":"hover:scale-102 transition-transform"," ").concat("use_prepaid_code"===e?"bg-primary hover:bg-primary/90 text-primary-foreground":"Easy"===e||"Medium"===e||"Advanced"===e?"bg-blue-50 border border-blue-200 hover:bg-blue-100 text-blue-800":"start_over"===e?"bg-gray-100 hover:bg-gray-200 text-gray-800":"bg-white hover:bg-gray-50 border border-gray-200 shadow-sm"),onClick:function(){ev&&("Easy"===e||"Medium"===e||"Advanced"===e||"start_over"===e)||("use_prepaid_code"===e?e_(e):"Easy"===e||"Medium"===e||"Advanced"===e?ew(e):ej(e))},children:"use_prepaid_code"===e?(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("span",{className:"mr-2 text-xs",children:"\uD83D\uDCB3"}),(0,d.jsx)("span",{children:"Use Prepaid Code"})]}):"start_over"===e?(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("span",{className:"mr-2 text-xs",children:"\uD83D\uDD04"}),(0,d.jsx)("span",{children:(0,_.GJ)(e)})]}):"Easy"===e||"Medium"===e||"Advanced"===e?(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("span",{className:"mr-2 text-xs",children:"Easy"===e?"⭐":"Medium"===e?"⭐⭐":"⭐⭐⭐"}),(0,d.jsx)("span",{children:e}),(0,d.jsxs)("span",{className:"ml-2 text-xs font-normal text-gray-500",children:["(",U[e]," min)"]})]}):(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("span",{className:"mr-2 text-xs",children:"→"}),(0,d.jsx)("span",{children:(0,_.GJ)(e)})]})},t)})};return(0,d.jsx)("div",{className:"flex flex-col h-full bg-background",children:eu?ex?(0,d.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,d.jsxs)("div",{className:"text-center p-6 max-w-md",children:[(0,d.jsx)("div",{className:"text-red-500 text-4xl mb-4",children:"⚠️"}),(0,d.jsx)("h3",{className:"text-lg font-medium text-red-800 mb-2",children:"Error Loading Chat"}),(0,d.jsx)("p",{className:"text-gray-600 mb-4",children:ex}),(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Please check the company ID in your URL or contact support for assistance."})]})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"py-3 px-4 border-b",children:(0,d.jsxs)(w.bZ,{className:"border-primary/20 bg-primary/5",children:[(0,d.jsx)(b.Z,{className:"h-4 w-4 text-primary"}),(0,d.jsxs)(w.Cd,{className:"text-sm font-medium",children:["Time Remaining: ","".concat(Math.floor(G/60),"h ").concat(G%60,"m")]})]})}),(0,d.jsxs)(v,{className:"flex-1 px-4 py-3",children:[(0,d.jsx)(k.M,{initial:!1,mode:"sync",children:Y.map(function(e,t){return(0,d.jsx)(S.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,height:0,marginBottom:0,overflow:"hidden"},transition:{duration:.3,ease:[.4,0,.2,1]},className:"flex ".concat("user"===e.role?"justify-end":"justify-start"," mb-5"),children:(0,d.jsxs)("div",{className:"flex items-start max-w-[80%] ".concat("user"===e.role?"flex-row-reverse":"flex-row"),children:[(0,d.jsx)(y.qE,{className:"w-8 h-8 ".concat("user"===e.role?"ml-3":"mr-3"," flex-shrink-0"),children:(0,d.jsx)(y.Q5,{className:"user"===e.role?"bg-primary":"bg-muted",children:"ai"===e.role?(0,d.jsx)(N.Z,{className:"w-4 h-4 text-foreground/80"}):(0,d.jsx)(j.Z,{className:"w-4 h-4 text-primary-foreground"})})}),(0,d.jsxs)("div",{className:"p-3 rounded-lg ".concat("user"===e.role?"bg-primary text-primary-foreground":"bg-muted text-foreground"),children:[(0,d.jsx)("p",{className:"text-sm",children:"ai"===e.role?(0,d.jsx)(D,{text:e.content,messageIndex:t,onComplete:ey}):e.content}),e.options&&(0,d.jsx)(d.Fragment,{children:"ai"===e.role?eo[t]===e.content&&(0,d.jsx)(S.E.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{duration:.3},className:"mt-3 space-y-2",children:eS(e.options)}):(0,d.jsx)("div",{className:"mt-3 space-y-2",children:eS(e.options)})})]})]})},t)})}),q&&(0,d.jsx)("div",{className:"flex justify-start mb-4",children:(0,d.jsxs)("div",{className:"flex items-start",children:[(0,d.jsx)(y.qE,{className:"w-8 h-8 mr-3 flex-shrink-0",children:(0,d.jsx)(y.Q5,{className:"bg-muted",children:(0,d.jsx)(N.Z,{className:"w-4 h-4 text-foreground/80"})})}),(0,d.jsx)(T.Zb,{className:"p-2 bg-muted border-none shadow-none",children:(0,d.jsx)(T.aY,{className:"p-2",children:(0,d.jsx)(Z,{})})})]})}),(0,d.jsx)("div",{ref:ee})]}),(0,d.jsx)(C.aR,{open:X,onOpenChange:$,children:(0,d.jsxs)(C._T,{className:"sm:max-w-md",children:[(0,d.jsxs)(C.fY,{children:[(0,d.jsx)(C.f$,{children:"Confirm Interview Generation"}),(0,d.jsxs)(C.yT,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"border rounded-lg p-4 bg-muted/50",children:[(0,d.jsx)("p",{className:"font-medium mb-2 text-sm",children:"Selected Interview Details:"}),(0,d.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Category:"})," ",A.text]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Complexity:"})," ",Q]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Duration:"})," ",U[Q]," minutes"]})]})]}),(0,d.jsxs)("div",{className:"flex gap-2 items-start p-3 bg-amber-50 rounded-md border border-amber-200",children:[(0,d.jsx)(b.Z,{className:"h-4 w-4 text-amber-600 mt-0.5 flex-shrink-0"}),(0,d.jsxs)("p",{className:"text-amber-800 text-sm",children:["This action will deduct ",U[Q]," minutes from your remaining time and cannot be reversed."]})]})]})]}),(0,d.jsxs)(C.xo,{className:"mt-4",children:[(0,d.jsx)(C.le,{onClick:function(){return eC(!1)},children:"Cancel"}),(0,d.jsx)(C.OL,{onClick:function(){return eC(!0)},className:"bg-primary hover:bg-primary/90",children:"Generate Interview"})]})]})}),(0,d.jsx)(C.aR,{open:es,onOpenChange:en,children:(0,d.jsxs)(C._T,{className:"sm:max-w-md",children:[(0,d.jsxs)(C.fY,{children:[(0,d.jsx)(C.f$,{children:"Enter Prepaid Code"}),(0,d.jsx)(C.yT,{children:"Please enter your prepaid code to add more minutes."})]}),(0,d.jsx)("div",{className:"grid gap-4 py-4",children:(0,d.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,d.jsx)(E.Label,{htmlFor:"prepaid-code",className:"text-right text-sm",children:"Code"}),(0,d.jsx)(I.I,{id:"prepaid-code",value:ea,onChange:function(e){return ei(e.target.value)},className:"col-span-3",placeholder:"Enter your code"})]})}),(0,d.jsxs)(C.xo,{children:[(0,d.jsx)(C.le,{onClick:function(){return en(!1)},children:"Cancel"}),(0,d.jsx)(C.OL,{onClick:ek,children:"Submit"})]})]})})]}):(0,d.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,d.jsx)("div",{className:"space-y-3",children:(0,d.jsxs)("div",{className:"flex space-x-2 items-center",children:[(0,d.jsx)("div",{className:"w-1.5 h-1.5 bg-primary rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,d.jsx)("div",{className:"w-1.5 h-1.5 bg-primary rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,d.jsx)("div",{className:"w-1.5 h-1.5 bg-primary rounded-full animate-bounce",style:{animationDelay:"300ms"}}),(0,d.jsx)("span",{className:"text-sm text-gray-500 ml-2",children:"Loading interviews for you..."})]})})})})}function Z(){var e=(0,l._)((0,u.useState)(0),2),t=e[0],s=e[1],n=(0,l._)((0,u.useState)([]),2),r=n[0],a=n[1],i=(0,l._)((0,u.useState)(Date.now()),1)[0],o=["AI is generating","Generating your questions","Generating your video infrastructure","Finalizing your interview"];return(0,u.useEffect)(function(){var e=setInterval(function(){var e=Math.min(Math.floor((Date.now()-i)/1e4),o.length-1);s(e);for(var t=[],n=0;n<e;n++)t.push(n);a(t)},100);return function(){clearInterval(e)}},[i,o.length]),(0,d.jsx)("div",{className:"space-y-3",children:o.map(function(e,s){return(0,d.jsxs)("div",{className:"flex items-center space-x-3 min-h-[1.75rem]",children:[(0,d.jsx)("div",{className:"w-6 flex justify-center",children:r.includes(s)?(0,d.jsx)("span",{className:"text-green-500 text-base animate-fade-in",children:"✓"}):t===s?(0,d.jsxs)("div",{className:"flex space-x-1",children:[(0,d.jsx)("div",{className:"w-1.5 h-1.5 bg-primary rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,d.jsx)("div",{className:"w-1.5 h-1.5 bg-primary rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,d.jsx)("div",{className:"w-1.5 h-1.5 bg-primary rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}):(0,d.jsx)("span",{className:"w-4"})}),(0,d.jsx)("span",{className:"transition-colors duration-300 text-sm ".concat(r.includes(s)?"text-green-500 font-medium":t===s?"text-primary font-medium":"text-muted-foreground"),children:e})]},s)})})}var z=s(27107),M=s(12339),A=s(86595),P=s(74767),V=s(87117),q=s(76858),F=s(32759),L=s(51817),G=s(32489),O=s(76865),J=s(70933),H=s(92451),B=s(10407),X=s(88178),$=s(33276),W=s(35153),Q=s(24457),K=s.n(Q),ee=s(57970),et={WIDTH:1280,HEIGHT:720};function es(e){var t,s,n,a,i,m,x,h=e.onClose,p=e.onComplete,v=e.questionSetId,g=e.category,y=e.complexity,N=(0,W.pm)().toast,j=(0,l._)((0,u.useState)(0),2),_=j[0],T=j[1],E=(0,l._)((0,u.useState)(!1),2),I=E[0],U=E[1],R=(0,l._)((0,u.useState)(!1),2),D=R[0],Y=R[1],Z=(0,l._)((0,u.useState)(0),2),z=Z[0],M=Z[1],A=(0,l._)((0,u.useState)([]),2),P=A[0],V=A[1],q=(0,l._)((0,u.useState)(""),2),Q=q[0],es=q[1],en=(0,l._)((0,u.useState)(!0),2),er=en[0],ea=en[1],ei=(0,l._)((0,u.useState)(null),2),el=ei[0],eo=ei[1],ec=(0,l._)((0,u.useState)(!1),2),ed=ec[0],eu=ec[1],em=(0,l._)((0,u.useState)(0),2),ef=em[0],ex=em[1],eh=(0,l._)((0,u.useState)([]),2),ep=(eh[0],eh[1]),ev=(0,l._)((0,u.useState)(0),2),eg=ev[0],ey=ev[1],eb=(0,l._)((0,u.useState)(!1),2),eN=eb[0],ej=eb[1],ew=(0,l._)((0,u.useState)(!1),2),e_=ew[0],eC=ew[1],ek=(0,u.useRef)(null),eS=(0,u.useRef)(null),eT=(0,u.useRef)(null),eE=(0,u.useRef)([]),eI=(0,u.useRef)(null),eU=(0,u.useRef)(null),eR=(0,u.useRef)(null),eD=(t=(0,r._)(function(){var e;return(0,c.Jh)(this,function(t){switch(t.label){case 0:eo(null),t.label=1;case 1:return t.trys.push([1,5,,6]),eI.current&&eI.current.getTracks().forEach(function(e){return e.stop()}),eS.current&&(eS.current.srcObject=null),[4,navigator.mediaDevices.getUserMedia({video:{width:{ideal:et.WIDTH},height:{ideal:et.HEIGHT}},audio:!0})];case 2:if(e=t.sent(),!eS.current)return[3,4];return eS.current.srcObject=e,eI.current=e,[4,new Promise(function(e){eS.current&&(eS.current.onloadedmetadata=function(){return e(!0)})})];case 3:t.sent(),Y(!0),eo(null),t.label=4;case 4:return[3,6];case 5:return console.error("Camera preview error:",t.sent()),eo("Unable to access camera. Please check permissions."),Y(!1),[3,6];case 6:return[2]}})}),function(){return t.apply(this,arguments)}),eY=function(){eI.current&&(eI.current.getTracks().forEach(function(e){return e.stop()}),eI.current=null),eS.current&&(eS.current.srcObject=null),Y(!1)};(0,u.useEffect)(function(){return eD(),function(){eY()}},[]),(0,u.useEffect)(function(){var e;if(!v){eo("No question set ID provided"),ea(!1);return}(e=(0,r._)(function(){var e,t,s,n,r,a,i,l,o,d;return(0,c.Jh)(this,function(c){switch(c.label){case 0:c.trys.push([0,12,13,14]),ea(!0),e=["data/mock-interviews/".concat(v,".json")],t=null,s=!0,n=!1,r=void 0,c.label=1;case 1:c.trys.push([1,8,9,10]),a=e[Symbol.iterator](),c.label=2;case 2:if(s=(i=a.next()).done)return[3,7];l=i.value,c.label=3;case 3:return c.trys.push([3,5,,6]),[4,fetch(l)];case 4:if((t=c.sent()).ok)return[3,7];return[3,6];case 5:return c.sent(),[3,6];case 6:return s=!0,[3,2];case 7:return[3,10];case 8:return o=c.sent(),n=!0,r=o,[3,10];case 9:try{s||null==a.return||a.return()}finally{if(n)throw r}return[7];case 10:if(!t||!t.ok)throw Error("Failed to fetch from any URL. Last status: ".concat(null==t?void 0:t.status));return[4,t.json()];case 11:return V((d=c.sent()).questions),es(d.title),M(d.time_limit),[3,14];case 12:return console.error("Error loading questions:",c.sent()),eo("Failed to load interview questions"),[3,14];case 13:return ea(!1),[7];case 14:return[2]}})}),function(){return e.apply(this,arguments)})()},[v]),(0,u.useEffect)(function(){var e;return I&&z>0&&!e_?e=setInterval(function(){M(function(e){return e-1})},1e3):0===z&&I&&eF(),function(){return clearInterval(e)}},[I,z,e_]);var eZ=(s=(0,r._)(function(){var e,t;return(0,c.Jh)(this,function(s){switch(s.label){case 0:if(!ek.current)return[2,null];s.label=1;case 1:if(s.trys.push([1,3,,4]),!((e=I?ek.current.querySelector(".question-content"):ek.current.querySelector(".content-section"))instanceof HTMLElement))return console.error("Content section not found"),[2,null];return[4,K()(e,{backgroundColor:"white",scale:window.devicePixelRatio||1,width:Math.floor(.6*et.WIDTH),height:et.HEIGHT,useCORS:!0,logging:!0})];case 2:return t=s.sent(),[2,{timestamp:Date.now()-eg,imageData:t,questionIndex:_}];case 3:return console.error("Error taking snapshot:",s.sent()),[2,null];case 4:return[2]}})}),function(){return s.apply(this,arguments)}),ez=(n=(0,r._)(function(){var e,t,s,n,r,a,i,l,o,d;return(0,c.Jh)(this,function(c){switch(c.label){case 0:if(!ek.current)return[2];c.label=1;case 1:return c.trys.push([1,4,,5]),[4,navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0,preferCurrentTab:!0,systemAudio:"include"})];case 2:return e=c.sent(),eU.current=e,[4,navigator.mediaDevices.getUserMedia({audio:!0})];case 3:return t=c.sent(),s=new MediaStream,e.getVideoTracks().forEach(function(e){s.addTrack(e)}),r=(n=new AudioContext).createMediaStreamDestination(),e.getAudioTracks().length>0&&(a=n.createMediaStreamSource(e),(i=n.createGain()).gain.value=1,a.connect(i).connect(r)),l=n.createMediaStreamSource(t),(o=n.createGain()).gain.value=1,l.connect(o).connect(r),r.stream.getAudioTracks().forEach(function(e){s.addTrack(e)}),eR.current=s,d=new MediaRecorder(s,{mimeType:"video/webm;codecs=vp9,opus"}),eT.current=d,eE.current=[],d.ondataavailable=function(e){e.data.size>0&&eE.current.push(e.data)},d.start(1e3),ey(Date.now()),U(!0),e.getVideoTracks()[0].onended=function(){e_||eF()},[3,5];case 4:return console.error("Error starting screen recording:",c.sent()),N({title:"Recording Error",description:"Failed to start screen recording. Please try again.",variant:"destructive"}),[3,5];case 5:return[2]}})}),function(){return n.apply(this,arguments)}),eM=function(){eT.current&&"recording"===eT.current.state&&(eT.current.pause(),eC(!0))},eA=function(){eT.current&&"paused"===eT.current.state&&(eT.current.resume(),eC(!1))},eP=(a=(0,r._)(function(){var e;return(0,c.Jh)(this,function(t){switch(t.label){case 0:if(!I)return[3,2];return[4,eZ()];case 1:(e=t.sent())&&ep(function(t){return(0,o._)(t).concat([e])}),t.label=2;case 2:return[2]}})}),function(){return a.apply(this,arguments)});(0,u.useEffect)(function(){I&&eP()},[_]);var eV=(i=(0,r._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:if(0===P.length)return eo("No questions available"),[2];return[4,ez()];case 1:return e.sent(),[2]}})}),function(){return i.apply(this,arguments)}),eq=function(e){ej(!1),e?eF():eA()},eF=(m=(0,r._)(function(){var e,t;return(0,c.Jh)(this,function(s){switch(s.label){case 0:if(!eT.current||!I)return[2];eT.current.stop(),U(!1),eC(!1),eu(!0),s.label=1;case 1:return s.trys.push([1,3,4,5]),[4,new Promise(function(e){return setTimeout(e,1500)})];case 2:return s.sent(),e=new Blob(eE.current,{type:"video/webm"}),t=URL.createObjectURL(e),eU.current&&(eU.current.getTracks().forEach(function(e){e.stop()}),eU.current=null),eR.current&&(eR.current.getTracks().forEach(function(e){e.stop()}),eR.current=null),eT.current.stream&&eT.current.stream.getTracks().forEach(function(e){e.stop()}),p(t),[3,5];case 3:return console.error("Error processing video:",s.sent()),N({title:"Processing Error",description:"Failed to process the recording. Please try again.",variant:"destructive"}),[3,5];case 4:return eu(!1),ex(0),[7];case 5:return[2]}})}),function(){return m.apply(this,arguments)});(0,u.useEffect)(function(){return function(){eU.current&&(eU.current.getTracks().forEach(function(e){e.stop()}),eU.current=null),eR.current&&(eR.current.getTracks().forEach(function(e){e.stop()}),eR.current=null)}},[]);var eL=function(e){return"".concat(Math.floor(e/60),":").concat((e%60).toString().padStart(2,"0"))};return er?(0,d.jsx)(S.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,d.jsxs)("div",{className:"bg-background p-6 rounded-lg shadow-md flex flex-col items-center",children:[(0,d.jsx)(L.Z,{className:"h-8 w-8 animate-spin text-primary"}),(0,d.jsx)("p",{className:"mt-4 text-sm text-muted-foreground",children:"Loading interview questions..."})]})}):ed?(0,d.jsx)(S.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,d.jsxs)("div",{className:"bg-background p-6 rounded-lg shadow-md w-[400px]",children:[(0,d.jsxs)("div",{className:"mb-4 space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Processing recording"}),(0,d.jsxs)("span",{className:"font-medium",children:[Math.round(ef),"%"]})]}),(0,d.jsx)(F.E,{value:ef,className:"h-2"})]}),(0,d.jsxs)("div",{className:"flex space-x-1",children:[(0,d.jsx)("div",{className:"w-1.5 h-1.5 bg-primary rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,d.jsx)("div",{className:"w-1.5 h-1.5 bg-primary rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,d.jsx)("div",{className:"w-1.5 h-1.5 bg-primary rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})}):(0,d.jsxs)(S.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:[(0,d.jsxs)("div",{ref:ek,className:"bg-background rounded-lg shadow-md w-[90vw] h-[90vh] flex flex-col border border-border overflow-hidden",children:[(0,d.jsxs)("div",{className:"py-3 px-4 border-b flex justify-between items-center",children:[(0,d.jsxs)("div",{className:"flex flex-col",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[g&&(0,d.jsxs)("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 border border-blue-200",children:[function(e){switch(e){case"Easy":default:return"⭐";case"Medium":return"⭐⭐";case"Advanced":return"⭐⭐⭐"}}(y||"Easy")," ",y]}),g&&(0,d.jsx)("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-gray-50 text-gray-700 border border-gray-200",children:g})]}),(0,d.jsx)("h1",{className:"text-lg font-semibold",children:Q.split("\n")[0].replace(/^#\s+/,"")})]}),!I&&(0,d.jsx)(f.z,{variant:"ghost",size:"icon",className:"rounded-full h-8 w-8",onClick:h,children:(0,d.jsx)(G.Z,{className:"h-4 w-4"})})]}),I&&(0,d.jsxs)("div",{className:"px-4 py-2 flex items-center justify-between ".concat(e_?"bg-amber-50 border-b border-amber-200":"bg-primary/5 border-b border-primary/20"),children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(b.Z,{className:"h-4 w-4 mr-2 ".concat(e_?"text-amber-600":"text-primary")}),(0,d.jsxs)("span",{className:"text-sm font-medium",children:["Time remaining: ",eL(z)]})]}),e_&&(0,d.jsx)("div",{className:"flex items-center",children:(0,d.jsxs)("span",{className:"text-xs font-medium text-amber-600 flex items-center",children:[(0,d.jsx)(O.Z,{className:"h-3 w-3 mr-1"}),"Recording paused"]})})]}),(0,d.jsxs)("div",{className:"flex-grow grid grid-cols-5 gap-6 p-4 overflow-hidden",children:[(0,d.jsx)("div",{className:"content-section col-span-3 border rounded-lg overflow-hidden flex flex-col",children:I?(0,d.jsx)(k.M,{mode:"wait",children:(0,d.jsxs)(S.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"flex-grow flex flex-col p-4",children:[(0,d.jsx)("div",{className:"flex items-center mb-2",children:(0,d.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Question ",_+1," of ",P.length]})}),(0,d.jsx)("div",{className:"question-content flex-grow overflow-y-auto mb-4",children:(0,d.jsx)("div",{dangerouslySetInnerHTML:{__html:'\n                            <style>\n                              .md-content h1 { font-size: 1.8em; font-weight: bold; margin-bottom: 0.5em; }\n                              .md-content h2 { font-size: 1.5em; font-weight: bold; margin-bottom: 0.5em; }\n                              .md-content pre { background-color: #f4f4f4; padding: 1rem; border-radius: 4px; }\n                              .md-content ul { list-style-type: disc; margin-left: 1.5em; }\n                              .md-content ol { list-style-type: decimal; margin-left: 1.5em; }\n                            </style>\n                            <div class="md-content">'.concat((0,ee.TU)((null===(x=P[_])||void 0===x?void 0:x.question)||""),"</div>\n                          ")},className:"question-content flex-grow overflow-y-auto mb-4"})}),(0,d.jsxs)("div",{className:"flex justify-between mt-auto pt-2 border-t",children:[(0,d.jsxs)(f.z,{onClick:function(){_>0&&T(function(e){return e-1})},disabled:0===_,variant:"ghost",size:"sm",className:"text-xs",children:[(0,d.jsx)(H.Z,{className:"mr-1 h-4 w-4"})," Previous"]}),(0,d.jsxs)(f.z,{onClick:function(){_<P.length-1&&T(function(e){return e+1})},disabled:_===P.length-1,variant:"ghost",size:"sm",className:"text-xs",children:["Next ",(0,d.jsx)(B.Z,{className:"ml-1 h-4 w-4"})]})]})]},_)}):(0,d.jsx)("div",{className:"flex-grow flex flex-col p-4",children:(0,d.jsxs)("div",{className:"space-y-5",children:[(0,d.jsxs)("div",{className:"bg-primary/5 border border-primary/20 rounded-lg overflow-hidden",children:[(0,d.jsxs)("div",{className:"bg-primary/10 border-b border-primary/20 px-4 py-2 flex items-center",children:[(0,d.jsx)(J.Z,{className:"h-5 w-5 text-primary mr-2"}),(0,d.jsx)("h3",{className:"text-base font-medium text-primary",children:"Interview Instructions"})]}),(0,d.jsx)("div",{className:"p-4",children:(0,d.jsxs)("ul",{className:"space-y-3 text-sm",children:[(0,d.jsxs)("li",{className:"flex items-start",children:[(0,d.jsx)("div",{className:"bg-primary/20 h-5 w-5 rounded-full flex items-center justify-center text-xs text-primary font-medium mr-2 mt-0.5 flex-shrink-0",children:"1"}),(0,d.jsx)("div",{children:"Take a moment to position yourself and check your camera view"})]}),(0,d.jsxs)("li",{className:"flex items-start",children:[(0,d.jsx)("div",{className:"bg-primary/20 h-5 w-5 rounded-full flex items-center justify-center text-xs text-primary font-medium mr-2 mt-0.5 flex-shrink-0",children:"2"}),(0,d.jsx)("div",{children:"Each response will be recorded for your review"})]}),(0,d.jsxs)("li",{className:"flex items-start",children:[(0,d.jsx)("div",{className:"bg-primary/20 h-5 w-5 rounded-full flex items-center justify-center text-xs text-primary font-medium mr-2 mt-0.5 flex-shrink-0",children:"3"}),(0,d.jsxs)("div",{children:["You'll have ",Math.floor(z/60)," minutes to complete all questions"]})]}),(0,d.jsxs)("li",{className:"flex items-start",children:[(0,d.jsx)("div",{className:"bg-primary/20 h-5 w-5 rounded-full flex items-center justify-center text-xs text-primary font-medium mr-2 mt-0.5 flex-shrink-0",children:"4"}),(0,d.jsx)("div",{children:"Ensure you speak clearly and maintain good posture"})]})]})})]}),(0,d.jsxs)("div",{className:"rounded-lg border border-amber-200 overflow-hidden",children:[(0,d.jsxs)("div",{className:"bg-amber-50 px-4 py-2 border-b border-amber-200 flex items-center",children:[(0,d.jsx)(b.Z,{className:"h-5 w-5 text-amber-600 mr-2"}),(0,d.jsx)("h3",{className:"text-base font-medium text-amber-800",children:"Before you begin"})]}),(0,d.jsx)("div",{className:"bg-amber-50/50 p-4",children:(0,d.jsxs)("div",{className:"space-y-2.5",children:[(0,d.jsxs)("label",{className:"flex items-center text-sm text-amber-900",children:[(0,d.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-amber-300 text-amber-600 mr-2"}),(0,d.jsx)("span",{children:"Ensure you're in a quiet environment"})]}),(0,d.jsxs)("label",{className:"flex items-center text-sm text-amber-900",children:[(0,d.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-amber-300 text-amber-600 mr-2"}),(0,d.jsx)("span",{children:"Check your camera position and lighting"})]}),(0,d.jsxs)("label",{className:"flex items-center text-sm text-amber-900",children:[(0,d.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-amber-300 text-amber-600 mr-2"}),(0,d.jsx)("span",{children:"Test your microphone"})]}),(0,d.jsxs)("label",{className:"flex items-center text-sm text-amber-900",children:[(0,d.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-amber-300 text-amber-600 mr-2"}),(0,d.jsx)("span",{children:"Have water nearby if needed"})]})]})})]})]})})}),(0,d.jsxs)("div",{className:"col-span-2 flex flex-col space-y-4",children:[(0,d.jsxs)("div",{className:"flex-grow rounded-lg overflow-hidden relative border border-gray-200 bg-gray-50",children:[el&&(0,d.jsxs)(w.bZ,{variant:"destructive",className:"absolute top-4 left-4 right-4 z-10",children:[(0,d.jsx)(w.Cd,{children:"Camera Error"}),(0,d.jsx)(w.X,{children:el})]}),(0,d.jsx)("video",{ref:eS,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",style:{transform:"scaleX(-1)"}}),!D&&(0,d.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-50",children:[(0,d.jsx)(X.Z,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,d.jsx)("p",{className:"text-sm text-gray-600",children:"Camera preview unavailable"})]}),D&&!I&&(0,d.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,d.jsx)("div",{className:"border border-dashed border-gray-300 rounded-lg w-2/3 h-2/3 flex items-center justify-center",children:(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Position yourself within the frame"})})}),e_&&(0,d.jsx)("div",{className:"absolute inset-0 bg-amber-900/20 flex flex-col items-center justify-center",children:(0,d.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 shadow-md max-w-xs text-center",children:[(0,d.jsx)(O.Z,{className:"h-8 w-8 text-amber-600 mx-auto mb-2"}),(0,d.jsx)("p",{className:"text-sm font-medium text-amber-800",children:"Recording paused"}),(0,d.jsx)("p",{className:"text-xs text-amber-700 mt-1",children:"Please confirm or cancel to continue"})]})})]}),I?(0,d.jsxs)(f.z,{size:"sm",onClick:function(){if(z<=0){eF();return}eM(),ej(!0)},variant:"outline",className:"text-xs border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100",children:[(0,d.jsx)(J.Z,{className:"mr-1.5 h-4 w-4"})," Complete Interview"]}):(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center text-sm",children:[(0,d.jsx)(b.Z,{className:"h-4 w-4 mr-2 text-muted-foreground"}),(0,d.jsxs)("span",{className:"text-muted-foreground",children:["Duration: ",eL(z)]})]}),(0,d.jsxs)(f.z,{size:"sm",onClick:eV,disabled:0===z||0===P.length||!D,variant:"default",className:"text-xs",children:[(0,d.jsx)($.Z,{className:"mr-1.5 h-4 w-4"})," Start Interview"]})]})]})]})]}),(0,d.jsx)(C.aR,{open:eN,onOpenChange:ej,children:(0,d.jsxs)(C._T,{className:"sm:max-w-md",children:[(0,d.jsxs)(C.fY,{children:[(0,d.jsxs)(C.f$,{className:"flex items-center",children:[(0,d.jsx)(O.Z,{className:"h-5 w-5 text-amber-600 mr-2"}),(0,d.jsx)("span",{children:"Confirm Interview Completion"})]}),(0,d.jsxs)(C.yT,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"border rounded-lg p-4 bg-amber-50/50 border-amber-200",children:[(0,d.jsx)("p",{className:"font-medium mb-2 text-sm text-amber-900",children:"Warning: You still have time remaining"}),(0,d.jsxs)("div",{className:"space-y-2 text-sm text-amber-800",children:[(0,d.jsxs)("p",{className:"flex items-center",children:[(0,d.jsx)(b.Z,{className:"h-4 w-4 mr-2 text-amber-600"}),(0,d.jsxs)("span",{children:["Time remaining: ",(0,d.jsx)("span",{className:"font-medium",children:eL(z)})]})]}),(0,d.jsx)("p",{children:"Completing now will end your interview early and the remaining time will be lost."})]})]}),(0,d.jsx)("div",{className:"flex items-start p-3 bg-gray-50 rounded-md border border-gray-200",children:(0,d.jsx)("div",{className:"text-gray-800 text-sm",children:"Are you sure you want to complete your interview now?"})})]})]}),(0,d.jsxs)(C.xo,{className:"mt-4",children:[(0,d.jsx)(C.le,{onClick:function(){return eq(!1)},className:"text-xs",children:"Continue Recording"}),(0,d.jsx)(C.OL,{onClick:function(){return eq(!0)},className:"bg-blue-600 hover:bg-blue-700 text-xs",children:"Complete & Save"})]})]})})]})}var en=s(18229),er=s(41671),ea=s(96362),ei=s(33245),el=s(78867),eo=s(79235),ec=s(26110);function ed(e){var t,s,n=e.onClose,a=e.videoUrl,i=e.category,o=void 0===i?"":i,m=e.complexity,x=void 0===m?"Easy":m,h=e.onUploadSuccess,p=(0,W.pm)().toast,v=(0,l._)((0,u.useState)(a),2),g=v[0],y=v[1],b=(0,l._)((0,u.useState)(null),2),N=b[0],j=b[1],_=(0,l._)((0,u.useState)(null),2),C=_[0],k=_[1],T=(0,l._)((0,u.useState)(0),2),E=T[0],I=T[1],U=(0,l._)((0,u.useState)(!1),2),R=U[0],D=U[1],Y=(0,l._)((0,u.useState)(!1),2),Z=Y[0],z=Y[1],M=(0,l._)((0,u.useState)(!1),2),A=M[0],V=M[1],L=(0,l._)((0,u.useState)(!1),2),J=(L[0],L[1]),H=(0,l._)((0,u.useState)(!0),2),B=H[0],X=H[1],$=(0,l._)((0,u.useState)(0),2),Q=$[0],K=$[1],ee=(0,l._)((0,u.useState)(null),2),et=ee[0],es=ee[1];(0,u.useEffect)(function(){if(console.log("Initial URL processing:",a),null==a?void 0:a.includes("|")){var e=(0,l._)(a.split("|"),2),t=e[0],s=e[1];if(s&&s.includes("youtu")){y(a);var n=s.match(/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([^?&/]+)/),r=n?n[1]:null;r&&k(r)}else y(t)}else y(a)},[a]),(0,u.useEffect)(function(){console.log("1. ViewModal - Current state:",{videoUrl:g,initialVideoUrl:a,parsedUrl:{blobUrl:(null==g?void 0:g.includes("|"))?g.split("|")[0]:g,youtubeUrl:(null==g?void 0:g.includes("|"))?g.split("|")[1]:null},videoId:C,isYouTubeVideo:(null==g?void 0:g.includes("youtu"))||(null==g?void 0:g.includes("|")),urlContainsYouTube:null==g?void 0:g.includes("youtu"),hasVideoId:!!C})},[g,a,C]),(0,u.useEffect)(function(){if((null==g?void 0:g.includes("youtu.be/"))||(null==g?void 0:g.includes("youtube.com/"))){var e=g.match(/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([^?&/]+)/),t=e?e[1]:null;t&&(k(t),fetch("https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=".concat(t,"&format=json")).then(function(e){X(e.ok)}).catch(function(){X(!1)}))}},[g]);var ed=function(){V(!0),K(1),D(!0)},eu=(0,en.Nq)({onSuccess:(t=(0,r._)(function(e){return(0,c.Jh)(this,function(t){return console.log("Login Success:",e),j(e.access_token),K(3),p({title:"Step 1 Complete",description:"Successfully logged in, now uploading video...",duration:3e3}),setTimeout(function(){e.access_token&&em(e.access_token)},1e3),[2]})}),function(e){return t.apply(this,arguments)}),onError:function(e){console.error("Login Failed:",e),es("Google login failed. Please try again."),V(!1),K(0),p({title:"Login Failed",description:"Could not login to Google",variant:"destructive",duration:5e3})},flow:"implicit",prompt:"consent",scope:"https://www.googleapis.com/auth/youtube.upload https://www.googleapis.com/auth/youtube https://www.googleapis.com/auth/youtube.force-ssl"}),em=(s=(0,r._)(function(e){var t,s,n,r,a,i,l,d,u,m,f,v,b,j,w,_,C;return(0,c.Jh)(this,function(c){switch(c.label){case 0:if(!(t=e||N))return es("Authentication error. Please try again."),V(!1),K(0),[2];c.label=1;case 1:return c.trys.push([1,8,9,10]),J(!0),K(3),I(10),s=setInterval(function(){I(function(e){return e>=90?(clearInterval(s),e):e+Math.floor(10*Math.random())})},1e3),[4,fetch(g.includes("|")?g.split("|")[0]:g)];case 2:return[4,c.sent().blob()];case 3:return n=new File([c.sent()],"interview.webm",{type:"video/webm"}),r={snippet:{title:"Mock Interview - ".concat(o," (").concat(x,")"),description:"Interview Category: ".concat(o,"\nComplexity: ").concat(x,"\nRecorded on: ").concat(new Date().toLocaleDateString()),tags:["mock interview",o,x],categoryId:"22"},status:{privacyStatus:"unlisted"}},i="\r\n--"+(a="foo_bar_baz")+"\r\n",l="\r\n--"+a+"--",d=new Blob([i+"Content-Type: application/json; charset=UTF-8\r\n\r\n"+JSON.stringify(r)+i+"Content-Type: video/webm\r\nContent-Transfer-Encoding: binary\r\n\r\n"],{type:"text/plain"}),u=new Blob([n],{type:"video/webm"}),m=new Blob([l],{type:"text/plain"}),f=new Blob([d,u,m],{type:"multipart/mixed; boundary=".concat(a)}),[4,fetch("https://www.googleapis.com/upload/youtube/v3/videos?part=snippet,status&uploadType=multipart",{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"multipart/mixed; boundary=".concat(a),"X-Upload-Content-Length":f.size.toString()},body:f})];case 4:if(v=c.sent(),clearInterval(s),I(100),v.ok)return[3,6];return[4,v.text()];case 5:if(b=c.sent(),console.error("Upload response:",v.status,b),b.includes("youtubeSignupRequired")||b.includes("channelNotFound")||b.toLowerCase().includes("channel")||401===v.status)return es("You need to create a YouTube channel before uploading"),p({title:"YouTube Channel Required",description:"You need to create a YouTube channel first before uploading videos.",variant:"destructive",duration:1e4}),K(0),V(!1),[2];throw Error("Upload failed: ".concat(v.status," ").concat(b));case 6:return[4,v.json()];case 7:if((j=c.sent()).id)k(j.id),console.log("2. ViewModal - Upload success:",{originalVideoUrl:g,newYoutubeUrl:w="https://youtu.be/".concat(j.id),youtubeId:j.id}),y("".concat(g,"|").concat(w)),h&&(console.log("3. ViewModal - Calling onUploadSuccess with:",{localUrl:g,youtubeUrl:w,youtubeId:j.id}),h(g,w,j.id)),z(!0),p({title:"Upload Successful",description:"Your video has been uploaded to YouTube",duration:5e3});else throw Error((null===(_=j.error)||void 0===_?void 0:_.message)||"Upload failed");return[3,10];case 8:return console.error("Upload error:",C=c.sent()),es("".concat((null==C?void 0:C.message)||"Could not upload to YouTube")),p({title:"Upload Failed",description:"".concat((null==C?void 0:C.message)||"Could not upload to YouTube"),variant:"destructive",duration:5e3}),[3,10];case 9:return V(!1),K(0),I(0),J(!1),[7];case 10:return[2]}})}),function(e){return s.apply(this,arguments)});(0,u.useEffect)(function(){C&&Z&&setTimeout(function(){(0,eo.Z)({particleCount:100,spread:70,origin:{y:.6}})},300)},[C,Z]);var ef=function(){return 0===Q?0:1===Q?33:2===Q?66:66+E/100*34},ex={blobUrl:(null==g?void 0:g.includes("|"))?g.split("|")[0]:g,youtubeUrl:(null==g?void 0:g.includes("|"))?g.split("|")[1]:null},eh=(null==g?void 0:g.includes("youtu"))||null!=ex.youtubeUrl||!!C;return(0,u.useEffect)(function(){console.log("11. ViewModal - Rendering section:",{parsedUrl:ex,videoId:C,isYouTubeVideo:eh,isProcessing:A,hasError:!!et})},[ex,C,eh,A,et]),(0,d.jsxs)(S.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:[(0,d.jsxs)("div",{className:"bg-background rounded-lg shadow-md w-[90vw] h-[90vh] flex flex-col border border-border overflow-hidden",children:[(0,d.jsx)("div",{className:"py-3 px-4 border-b flex justify-between items-center",children:(0,d.jsx)(f.z,{variant:"ghost",size:"icon",className:"rounded-full h-8 w-8",onClick:n,disabled:A,children:(0,d.jsx)(G.Z,{className:"h-4 w-4"})})}),A&&(0,d.jsx)("div",{className:"px-4 py-2 bg-primary/5 border-b border-primary/20",children:(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between text-xs mb-1",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[1===Q&&(0,d.jsx)("span",{className:"text-primary font-medium",children:"Step 1: Instructions"}),2===Q&&(0,d.jsx)("span",{className:"text-primary font-medium",children:"Step 2: Google Authentication"}),3===Q&&(0,d.jsx)("span",{className:"text-primary font-medium",children:"Step 3: Uploading to YouTube"})]}),(0,d.jsxs)("span",{className:"text-muted-foreground",children:[Math.round(ef()),"%"]})]}),(0,d.jsx)(F.E,{value:ef(),className:"h-1.5"})]})}),(0,d.jsx)("div",{className:"flex-grow grid grid-cols-1 gap-6 p-4 overflow-hidden",children:(0,d.jsx)("div",{className:"border rounded-lg overflow-hidden flex flex-col",children:(0,d.jsxs)("div",{className:"flex-grow relative",children:[function(){if(!B&&(null==g?void 0:g.includes("youtu")))return(0,d.jsxs)("div",{className:"bg-gray-100 w-full h-full flex flex-col items-center justify-center p-8 text-center",children:[(0,d.jsx)(O.Z,{className:"h-12 w-12 text-amber-500 mb-4"}),(0,d.jsx)("h3",{className:"text-lg font-medium mb-2",children:"YouTube Video Unavailable"}),(0,d.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"This video is no longer available on YouTube. It may have been deleted or made private."})]});if(!ex.youtubeUrl)return(0,d.jsx)("video",{src:ex.blobUrl,controls:!0,className:"w-full h-full"});if(ex.youtubeUrl){var e,t=null===(e=ex.youtubeUrl.match(/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([^?&/]+)/))||void 0===e?void 0:e[1];if(t)return(0,d.jsx)("iframe",{src:"https://www.youtube.com/embed/".concat(t),className:"w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}return(0,d.jsx)("video",{src:ex.blobUrl,controls:!0,className:"w-full h-full"})}(),A&&2===Q&&(0,d.jsx)("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/40",children:(0,d.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-lg text-center space-y-3 max-w-sm",children:[(0,d.jsx)("div",{className:"flex justify-center",children:(0,d.jsxs)("div",{className:"flex space-x-1",children:[(0,d.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,d.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,d.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}),(0,d.jsx)("p",{className:"text-sm font-medium",children:"Waiting for Google Authentication"}),(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Please complete the Google sign-in process"}),(0,d.jsx)(f.z,{variant:"outline",size:"sm",className:"mt-2 text-xs",onClick:function(){V(!1),K(0),es("Authentication canceled. Please try again with a different account.")},children:"Cancel Authentication"})]})})]})})}),(0,d.jsx)("div",{className:"px-4 pb-4 pt-1 border-t",children:(0,d.jsx)("div",{className:"flex items-center gap-4",children:ex.youtubeUrl?(0,d.jsxs)("div",{className:"flex w-full items-center gap-4",children:[(0,d.jsxs)(w.bZ,{className:"flex-1 bg-green-50 border-green-200 text-green-800",children:[(0,d.jsx)(er.Z,{className:"h-4 w-4 text-green-600"}),(0,d.jsx)(w.Cd,{className:"text-sm font-medium text-green-800",children:"Video available on YouTube"}),(0,d.jsx)(w.X,{className:"text-xs mt-1 text-green-700",children:"Your recording is published as an unlisted video"})]}),(0,d.jsxs)(f.z,{onClick:function(){return window.open(ex.youtubeUrl||"","_blank")},size:"sm",className:"text-xs",children:[(0,d.jsx)(P.Z,{className:"mr-1.5 h-4 w-4"}),"Open on YouTube"]})]}):et?(0,d.jsxs)("div",{className:"flex w-full items-center gap-4",children:[(0,d.jsxs)(w.bZ,{className:"flex-1 bg-red-50 border-red-200 text-red-800",children:[(0,d.jsx)(O.Z,{className:"h-4 w-4 text-red-600"}),(0,d.jsx)(w.Cd,{className:"text-sm font-medium text-red-800",children:"Error"}),(0,d.jsxs)(w.X,{className:"text-xs mt-1 text-red-700",children:[et,(null==et?void 0:et.includes("YouTube channel"))&&(0,d.jsxs)("div",{className:"mt-2",children:[(0,d.jsxs)("a",{href:"https://www.youtube.com/create_channel",target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-blue-600 hover:underline font-medium",children:[(0,d.jsx)(ea.Z,{className:"h-3 w-3 mr-1"}),"Click here to create a YouTube channel"]}),(0,d.jsx)("p",{className:"mt-1 text-xs text-red-600",children:"After creating your channel, return here and try again"})]})]})]}),(0,d.jsxs)(f.z,{onClick:function(){es(null),ed()},disabled:A,variant:"default",size:"sm",className:"text-xs",children:[(0,d.jsx)(q.Z,{className:"mr-1.5 h-4 w-4"}),"Try Again"]})]}):A?(0,d.jsx)("div",{className:"flex-1",children:(0,d.jsxs)(w.bZ,{className:"bg-primary/5 border-primary/20",children:[(0,d.jsx)(ei.Z,{className:"h-4 w-4 text-primary"}),(0,d.jsx)(w.Cd,{className:"text-sm font-medium",children:"Processing your recording"}),(0,d.jsx)(w.X,{className:"text-xs mt-1",children:"Please complete all steps to save your recording"})]})}):(0,d.jsxs)("div",{className:"flex w-full items-center gap-4",children:[(0,d.jsxs)(w.bZ,{className:"flex-1 bg-primary/5 border-primary/20",children:[(0,d.jsx)(ei.Z,{className:"h-4 w-4 text-primary"}),(0,d.jsx)(w.Cd,{className:"text-sm font-medium",children:"Save your recording"}),(0,d.jsx)(w.X,{className:"text-xs mt-1",children:"Save your recording to YouTube as an unlisted video"})]}),(0,d.jsxs)(f.z,{onClick:ed,disabled:A,variant:"default",size:"sm",className:"text-xs",children:[(0,d.jsx)(P.Z,{className:"mr-1.5 h-4 w-4"}),"Save to YouTube"]})]})})})]}),(0,d.jsx)(ec.Vq,{open:R,onOpenChange:function(e){!e&&A&&(V(!1),K(0)),D(e)},children:(0,d.jsxs)(ec.cZ,{className:"sm:max-w-md",children:[(0,d.jsxs)(ec.fK,{children:[(0,d.jsx)(ec.$N,{children:"YouTube Upload Instructions"}),(0,d.jsx)(ec.Be,{children:"Please follow these steps to successfully upload your video:"})]}),(0,d.jsxs)("div",{className:"space-y-4 py-4",children:[(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("h3",{className:"font-medium",children:"Before you begin:"}),(0,d.jsxs)("ul",{className:"list-disc pl-5 space-y-1 text-sm",children:[(0,d.jsx)("li",{children:"You must have a YouTube channel associated with your Google account"}),(0,d.jsx)("li",{children:"If you don't have a YouTube channel yet, you'll need to create one first"})]})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("h3",{className:"font-medium",children:"Step 1: Login Process (TWO SCREENS)"}),(0,d.jsxs)("ul",{className:"list-disc pl-5 space-y-1 text-sm",children:[(0,d.jsx)("li",{children:"After clicking \"I Understand\", you'll see Google's login screens"}),(0,d.jsxs)("li",{children:[(0,d.jsx)("strong",{children:"First screen"}),": Choose your Google account"]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("strong",{children:"Second screen"}),": You'll see two options - your email account and YouTube account"]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("strong",{className:"text-red-500",children:"IMPORTANT: You MUST select the YouTube option"}),", not your email"]}),(0,d.jsx)("li",{children:"Selecting your email account instead of YouTube will cause an authorization error"})]})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("h3",{className:"font-medium",children:"Step 2: Creating a YouTube Channel (if needed)"}),(0,d.jsxs)("ul",{className:"list-disc pl-5 space-y-1 text-sm",children:[(0,d.jsx)("li",{children:"If you don't see a YouTube option on the second screen, you need to create a channel first"}),(0,d.jsx)("li",{children:(0,d.jsxs)("a",{href:"https://www.youtube.com/create_channel",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline flex items-center",children:["Click here to create a YouTube channel",(0,d.jsx)(ea.Z,{className:"h-3 w-3 ml-1"})]})}),(0,d.jsx)("li",{children:"Sign in with your Google account"}),(0,d.jsx)("li",{children:"Follow the prompts to complete channel creation"}),(0,d.jsx)("li",{children:"Return to this page and try again - you should now see two options on the second screen"})]})]})]}),(0,d.jsx)(ec.cN,{children:(0,d.jsx)(f.z,{onClick:function(){D(!1),K(2),eu()},children:"I Understand"})})]})}),(0,d.jsx)(ec.Vq,{open:Z,onOpenChange:z,children:(0,d.jsxs)(ec.cZ,{className:"sm:max-w-md",children:[(0,d.jsx)(ec.fK,{children:(0,d.jsx)(ec.$N,{className:"text-center",children:(0,d.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,d.jsx)(er.Z,{className:"h-5 w-5 text-green-600"}),(0,d.jsx)("span",{className:"text-xl",children:"Upload Successful!"})]})})}),(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-6 py-6",children:[(0,d.jsxs)("div",{className:"text-center space-y-2",children:[(0,d.jsx)("p",{className:"text-lg",children:"Your video has been uploaded to YouTube"}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"It's available as an unlisted video on your channel"})]}),(0,d.jsxs)("div",{className:"w-full p-4 bg-muted rounded-md",children:[(0,d.jsx)("p",{className:"font-medium mb-2",children:"Video Link:"}),(0,d.jsxs)("a",{href:ex.youtubeUrl||"https://youtu.be/".concat(C||""),target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700 hover:underline flex items-center justify-center gap-2 p-3 bg-card rounded border border-border transition-colors",children:[(0,d.jsx)(P.Z,{className:"h-5 w-5"}),ex.youtubeUrl||"https://youtu.be/".concat(C||"")]})]}),(0,d.jsxs)("div",{className:"flex gap-4",children:[(0,d.jsxs)(f.z,{onClick:function(){navigator.clipboard.writeText(ex.youtubeUrl||"https://youtu.be/".concat(C||"")),p({title:"Link copied",description:"YouTube URL copied to clipboard",duration:3e3})},variant:"outline",size:"sm",className:"text-xs",children:[(0,d.jsx)(el.Z,{className:"mr-1.5 h-4 w-4"}),"Copy Link"]}),(0,d.jsxs)(f.z,{onClick:function(){return window.open(ex.youtubeUrl||"https://youtu.be/".concat(C||""),"_blank")},size:"sm",className:"text-xs",children:[(0,d.jsx)(P.Z,{className:"mr-1.5 h-4 w-4"}),"Open Video"]})]})]})]})})]})}function eu(e){var t=e.images,s=e.filter,n=(e.onFilterChange,e.onToggleFavorite),r=e.onCompleteInterview,c=e.onUpdateImage,m=(0,l._)((0,u.useState)("new"),2),x=m[0],h=m[1],p=(0,l._)((0,u.useState)(null),2),g=p[0],y=p[1],N=(0,l._)((0,u.useState)(!1),2),j=N[0],_=N[1],C=(0,l._)((0,u.useState)(!1),2),k=C[0],T=C[1],E=(0,l._)((0,u.useState)(t),2),I=E[0],U=E[1];(0,u.useEffect)(function(){U(t)},[t]);var R=(0,o._)(I).sort(function(e,t){return"completed"===x&&e.completedAt&&t.completedAt?t.completedAt.getTime()-e.completedAt.getTime():t.createdAt.getTime()-e.createdAt.getTime()}),D=R.filter(function(e){return!e.isCompleted}),Y=R.filter(function(e){return e.isCompleted}),Z=R.filter(function(e){return e.isFavorite&&e.isCompleted}),F="all"===s?"new"===x?D:"completed"===x?Y:Z:("new"===x?D:"completed"===x?Y:Z).filter(function(e){return e.url.includes(s)}),L=function(e){if(!e)return!1;if(e.includes("|")){var t=e.split("|");return t.length>1&&t[1].includes("youtu")}return e.includes("youtu")},G=function(e){var t=F[e],s=I.findIndex(function(e){return e===t});t.isCompleted?(y(s),_(!0),T(!1)):t.questionSetId&&(y(s),T(!0),_(!1))},O=function(){y(null),_(!1),T(!1)},J=function(e){switch(e){case"Easy":default:return"⭐";case"Medium":return"⭐⭐";case"Advanced":return"⭐⭐⭐"}},H=function(e){return(0,d.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4",children:e.map(function(e,t){var s=e.complexity||"Easy",r=L(e.videoUrl);return(0,d.jsx)(S.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,ease:[.4,0,.2,1]},className:"flex flex-col",children:(0,d.jsxs)("div",{className:"relative rounded-lg border border-gray-200 shadow-sm bg-white hover:shadow-md hover:border-primary/20 transition-all duration-200 cursor-pointer overflow-hidden",onClick:function(){return G(t)},children:[(0,d.jsxs)("div",{className:"p-4",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,d.jsxs)("div",{className:"flex flex-col",children:[(0,d.jsxs)("span",{className:"text-xs font-medium text-gray-500 mb-1",children:[J(s)," ",s]}),(0,d.jsx)("h3",{className:"font-medium text-lg text-foreground line-clamp-2",children:e.category})]}),e.isCompleted&&(0,d.jsx)(f.z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full",onClick:function(t){t.stopPropagation(),n(I.findIndex(function(t){return t===e}))},children:(0,d.jsx)(A.Z,{className:"h-4 w-4 ".concat(e.isFavorite?"fill-yellow-400 text-yellow-400":"text-gray-400")})})]}),(0,d.jsx)("div",{className:"mb-3",children:e.isCompleted?(0,d.jsx)("div",{className:"flex items-center font-medium text-xs",children:r?(0,d.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,d.jsx)(P.Z,{className:"w-3.5 h-3.5 mr-1"}),(0,d.jsx)("span",{children:"Private Video"})]}):(0,d.jsxs)("div",{className:"flex items-center text-green-600",children:[(0,d.jsx)(V.Z,{className:"w-3.5 h-3.5 mr-1"}),(0,d.jsx)("span",{children:"Completed"})]})}):(0,d.jsxs)("div",{className:"flex items-center text-primary font-medium text-xs",children:[(0,d.jsx)(q.Z,{className:"w-3.5 h-3.5 mr-1"}),(0,d.jsx)("span",{children:"Ready to start"})]})}),(0,d.jsxs)("div",{className:"space-y-1.5 text-xs text-muted-foreground",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(b.Z,{className:"w-3 h-3 mr-1.5"}),(0,d.jsxs)("span",{children:["Created: ",(0,z.WU)(e.createdAt,"MMM d, yyyy")]})]}),e.completedAt&&(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(b.Z,{className:"w-3 h-3 mr-1.5"}),(0,d.jsxs)("span",{children:["Completed: ",(0,z.WU)(e.completedAt,"MMM d, yyyy")]})]})]})]}),(0,d.jsx)("div",{className:"px-4 py-2 text-xs font-medium ".concat(e.isCompleted?r?"bg-red-50 text-red-700":"bg-green-50 text-green-700":"bg-blue-50 text-primary"),children:e.isCompleted?"View Recording":"Start Interview"})]})},t)})})};return(0,d.jsxs)("div",{className:"flex flex-col h-full bg-background",children:[(0,d.jsx)("div",{className:"py-3 px-4 border-b",children:(0,d.jsx)("h2",{className:"text-lg font-semibold",children:"Assessment Vault"})}),(0,d.jsxs)(M.mQ,{value:x,onValueChange:function(e){return h(e)},className:"flex-1 flex flex-col",children:[(0,d.jsxs)(M.dr,{className:"grid w-full grid-cols-3 px-4 py-2",children:[(0,d.jsx)(M.SP,{value:"new",children:"New"}),(0,d.jsx)(M.SP,{value:"completed",children:"Completed"}),(0,d.jsx)(M.SP,{value:"favorites",children:"Favorites"})]}),(0,d.jsxs)(v,{className:"flex-1",children:[(0,d.jsx)(M.nU,{value:"new",className:"m-0",children:D.length>0?H(F):(0,d.jsxs)(w.bZ,{className:"m-4 border-primary/20 bg-primary/5",children:[(0,d.jsx)(w.Cd,{children:"No pending interviews"}),(0,d.jsx)(w.X,{children:"Please use the AI INTERVIEW ASSISTANT to generate interviews."})]})}),(0,d.jsx)(M.nU,{value:"completed",className:"m-0",children:Y.length>0?H(F):(0,d.jsxs)(w.bZ,{className:"m-4 border-primary/20 bg-primary/5",children:[(0,d.jsx)(w.Cd,{children:"No completed interviews"}),(0,d.jsx)(w.X,{children:"Complete a mock interview to see it here."})]})}),(0,d.jsx)(M.nU,{value:"favorites",className:"m-0",children:Z.length>0?H(F):(0,d.jsxs)(w.bZ,{className:"m-4 border-primary/20 bg-primary/5",children:[(0,d.jsx)(w.Cd,{children:"No favorites yet"}),(0,d.jsx)(w.X,{children:"Star your favorite completed interviews to see them here."})]})})]})]}),k&&null!==g&&!j&&(0,d.jsx)(es,{onClose:O,onComplete:function(e){null!==g&&(r(g,e),O())},questionSetId:I[g].questionSetId,category:I[g].category,complexity:I[g].complexity}),j&&null!==g&&(0,d.jsx)(ed,{onClose:O,videoUrl:I[g].videoUrl||"",category:I[g].category,complexity:I[g].complexity,onUploadSuccess:function(e,t,s){if(console.log("5. InterviewVault - handleYoutubeUploadSuccess called with:",{localUrl:e,youtubeUrl:t,youtubeId:s,selectedImageIndex:g}),null!==g&&c){console.log("6. InterviewVault - Before update, current state:",{currentVideoUrl:I[g].videoUrl,isYouTube:null===(n=I[g].videoUrl)||void 0===n?void 0:n.includes("youtu")});var n,r="".concat(e,"|").concat(t),l=(0,o._)(I);l[g]=(0,i._)((0,a._)({},l[g]),{videoUrl:r}),console.log("7. InterviewVault - Setting local images with new videoUrl:",r),U(l),console.log("8. InterviewVault - Calling onUpdateImage to update parent state"),c(g,{videoUrl:r}),console.log("9. InterviewVault - YouTube upload success handling complete")}}})]})}function em(){var e,t=(0,l._)((0,u.useState)([]),2),s=t[0],n=t[1],m=(0,l._)((0,u.useState)("all"),2),f=m[0],x=m[1],h=(0,W.pm)().toast,p=(e=(0,r._)(function(e,t,s,r){var a,i,l;return(0,c.Jh)(this,function(c){switch(c.label){case 0:console.log("Adding image with prompt:",e,"questionSetId:",t,"complexity:",s,"category:",r),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,new Promise(function(e){return setTimeout(e,3e3)})];case 2:return c.sent(),a="./placeholder.svg?height=300&width=300&text=".concat(encodeURIComponent(e)),t||console.warn("No questionSetId provided for image generation"),i={url:a,createdAt:new Date,isFavorite:!1,isCompleted:!1,questionSetId:t,complexity:s||"Easy",category:r||"General Interview"},n(function(e){return(0,o._)(e).concat([i])}),[2,a];case 3:throw console.error("Error adding image:",l=c.sent()),h({title:"Error",description:"Failed to generate image. Please try again.",variant:"destructive"}),l;case 4:return[2]}})}),function(t,s,n,r){return e.apply(this,arguments)});return(0,d.jsx)("div",{className:"container mx-auto px-2 py-4 h-[calc(100vh-4rem)] flex flex-col",children:(0,d.jsxs)("div",{className:"flex-1 grid grid-cols-10 gap-4 overflow-hidden",children:[(0,d.jsx)("div",{className:"col-span-4 border rounded-lg overflow-hidden",children:(0,d.jsx)(Y,{onSendMessage:console.log,onGenerateImage:function(e,t,s,n){return console.log("Generating image with:",{questionSetId:t,complexity:s,category:n}),p(e,t,s,n)}})}),(0,d.jsx)("div",{className:"col-span-6 border rounded-lg overflow-hidden",children:(0,d.jsx)(eu,{images:s,filter:f,onFilterChange:x,onToggleFavorite:function(e){n(function(t){var s=(0,o._)(t),n=s.filter(function(e){return e.isFavorite&&e.isCompleted}).length;return!s[e].isFavorite&&n>=10?h({title:"Favorite limit reached",description:"You can only have up to 10 favorite interviews. Please remove a favorite before adding a new one."}):s[e]=(0,i._)((0,a._)({},s[e]),{isFavorite:!s[e].isFavorite}),s})},onCompleteInterview:function(e,t){if(console.log("completeInterview called in page with index:",e,"videoUrl:",t),e<0||e>=s.length){console.error("Invalid image index:",e);return}if(s[e].isCompleted){console.warn("Interview already completed");return}n(function(s){var n=(0,o._)(s);return n[e]=(0,i._)((0,a._)({},n[e]),{isCompleted:!0,completedAt:new Date,videoUrl:t}),n})},onUpdateImage:function(e,t){if(console.log("updateImage called with index:",e,"data:",t),e<0||e>=s.length){console.error("Invalid image index:",e);return}n(function(s){var n=(0,o._)(s);return n[e]=(0,a._)({},n[e],t),console.log("Updated image in parent state:",n[e]),n})}})})]})})}},37099:function(e,t,s){"use strict";s.d(t,{OL:function(){return y},_T:function(){return x},aR:function(){return u},f$:function(){return v},fY:function(){return h},le:function(){return b},xo:function(){return p},yT:function(){return g}});var n=s(5194),r=s(1780),a=s(46796),i=s(57437),l=s(2265),o=s(90277),c=s(94508),d=s(62869),u=o.fC;o.xz;var m=o.h_,f=l.forwardRef(function(e,t){var s=e.className,l=(0,a._)(e,["className"]);return(0,i.jsx)(o.aV,(0,r._)((0,n._)({className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s)},l),{ref:t}))});f.displayName=o.aV.displayName;var x=l.forwardRef(function(e,t){var s=e.className,r=(0,a._)(e,["className"]);return(0,i.jsxs)(m,{children:[(0,i.jsx)(f,{}),(0,i.jsx)(o.VY,(0,n._)({ref:t,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s)},r))]})});x.displayName=o.VY.displayName;var h=function(e){var t=e.className,s=(0,a._)(e,["className"]);return(0,i.jsx)("div",(0,n._)({className:(0,c.cn)("flex flex-col space-y-2 text-center sm:text-left",t)},s))};h.displayName="AlertDialogHeader";var p=function(e){var t=e.className,s=(0,a._)(e,["className"]);return(0,i.jsx)("div",(0,n._)({className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t)},s))};p.displayName="AlertDialogFooter";var v=l.forwardRef(function(e,t){var s=e.className,r=(0,a._)(e,["className"]);return(0,i.jsx)(o.Dx,(0,n._)({ref:t,className:(0,c.cn)("text-lg font-semibold",s)},r))});v.displayName=o.Dx.displayName;var g=l.forwardRef(function(e,t){var s=e.className,r=(0,a._)(e,["className"]);return(0,i.jsx)(o.dk,(0,n._)({ref:t,className:(0,c.cn)("text-sm text-muted-foreground",s)},r))});g.displayName=o.dk.displayName;var y=l.forwardRef(function(e,t){var s=e.className,r=(0,a._)(e,["className"]);return(0,i.jsx)(o.aU,(0,n._)({ref:t,className:(0,c.cn)((0,d.d)(),s)},r))});y.displayName=o.aU.displayName;var b=l.forwardRef(function(e,t){var s=e.className,r=(0,a._)(e,["className"]);return(0,i.jsx)(o.$j,(0,n._)({ref:t,className:(0,c.cn)((0,d.d)({variant:"outline"}),"mt-2 sm:mt-0",s)},r))});b.displayName=o.$j.displayName},65613:function(e,t,s){"use strict";s.d(t,{Cd:function(){return u},X:function(){return m},bZ:function(){return d}});var n=s(5194),r=s(46796),a=s(57437),i=s(2265),l=s(90535),o=s(94508),c=(0,l.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=i.forwardRef(function(e,t){var s=e.className,i=e.variant,l=(0,r._)(e,["className","variant"]);return(0,a.jsx)("div",(0,n._)({ref:t,role:"alert",className:(0,o.cn)(c({variant:i}),s)},l))});d.displayName="Alert";var u=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("h5",(0,n._)({ref:t,className:(0,o.cn)("mb-1 font-medium leading-none tracking-tight",s)},i))});u.displayName="AlertTitle";var m=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,n._)({ref:t,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",s)},i))});m.displayName="AlertDescription"},16831:function(e,t,s){"use strict";s.d(t,{F$:function(){return d},Q5:function(){return u},qE:function(){return c}});var n=s(5194),r=s(46796),a=s(57437),i=s(2265),l=s(70650),o=s(94508),c=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)(l.fC,(0,n._)({ref:t,className:(0,o.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s)},i))});c.displayName=l.fC.displayName;var d=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)(l.Ee,(0,n._)({ref:t,className:(0,o.cn)("aspect-square h-full w-full",s)},i))});d.displayName=l.Ee.displayName;var u=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)(l.NY,(0,n._)({ref:t,className:(0,o.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s)},i))});u.displayName=l.NY.displayName},66070:function(e,t,s){"use strict";s.d(t,{Ol:function(){return c},SZ:function(){return u},Zb:function(){return o},aY:function(){return m},eW:function(){return f},ll:function(){return d}});var n=s(5194),r=s(46796),a=s(57437),i=s(2265),l=s(94508),o=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,n._)({ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s)},i))});o.displayName="Card";var c=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,n._)({ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s)},i))});c.displayName="CardHeader";var d=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,n._)({ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s)},i))});d.displayName="CardTitle";var u=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,n._)({ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s)},i))});u.displayName="CardDescription";var m=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,n._)({ref:t,className:(0,l.cn)("p-6 pt-0",s)},i))});m.displayName="CardContent";var f=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",(0,n._)({ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s)},i))});f.displayName="CardFooter"},26110:function(e,t,s){"use strict";s.d(t,{$N:function(){return v},Be:function(){return g},Vq:function(){return u},cN:function(){return p},cZ:function(){return x},fK:function(){return h}});var n=s(5194),r=s(1780),a=s(46796),i=s(57437),l=s(2265),o=s(49027),c=s(32489),d=s(94508),u=o.fC;o.xz;var m=o.h_;o.x8;var f=l.forwardRef(function(e,t){var s=e.className,r=(0,a._)(e,["className"]);return(0,i.jsx)(o.aV,(0,n._)({ref:t,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s)},r))});f.displayName=o.aV.displayName;var x=l.forwardRef(function(e,t){var s=e.className,l=e.children,u=(0,a._)(e,["className","children"]);return(0,i.jsxs)(m,{children:[(0,i.jsx)(f,{}),(0,i.jsxs)(o.VY,(0,r._)((0,n._)({ref:t,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s)},u),{children:[l,(0,i.jsxs)(o.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,i.jsx)(c.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})});x.displayName=o.VY.displayName;var h=function(e){var t=e.className,s=(0,a._)(e,["className"]);return(0,i.jsx)("div",(0,n._)({className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t)},s))};h.displayName="DialogHeader";var p=function(e){var t=e.className,s=(0,a._)(e,["className"]);return(0,i.jsx)("div",(0,n._)({className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t)},s))};p.displayName="DialogFooter";var v=l.forwardRef(function(e,t){var s=e.className,r=(0,a._)(e,["className"]);return(0,i.jsx)(o.Dx,(0,n._)({ref:t,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",s)},r))});v.displayName=o.Dx.displayName;var g=l.forwardRef(function(e,t){var s=e.className,r=(0,a._)(e,["className"]);return(0,i.jsx)(o.dk,(0,n._)({ref:t,className:(0,d.cn)("text-sm text-muted-foreground",s)},r))});g.displayName=o.dk.displayName},95186:function(e,t,s){"use strict";s.d(t,{I:function(){return o}});var n=s(5194),r=s(46796),a=s(57437),i=s(2265),l=s(94508),o=i.forwardRef(function(e,t){var s=e.className,i=e.type,o=(0,r._)(e,["className","type"]);return(0,a.jsx)("input",(0,n._)({type:i,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t},o))});o.displayName="Input"},26815:function(e,t,s){"use strict";s.d(t,{Label:function(){return u}});var n=s(5194),r=s(46796),a=s(57437),i=s(2265),l=s(6394),o=s(90535),c=s(94508),d=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)(l.f,(0,n._)({ref:t,className:(0,c.cn)(d(),s)},i))});u.displayName=l.f.displayName},32759:function(e,t,s){"use strict";s.d(t,{E:function(){return d}});var n=s(5194),r=s(1780),a=s(46796),i=s(57437),l=s(2265),o=s(60610),c=s(94508),d=l.forwardRef(function(e,t){var s=e.className,l=e.value,d=(0,a._)(e,["className","value"]);return(0,i.jsx)(o.fC,(0,r._)((0,n._)({ref:t,className:(0,c.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s)},d),{children:(0,i.jsx)(o.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(l||0),"%)")}})}))});d.displayName=o.fC.displayName},12339:function(e,t,s){"use strict";s.d(t,{SP:function(){return u},dr:function(){return d},mQ:function(){return c},nU:function(){return m}});var n=s(5194),r=s(46796),a=s(57437),i=s(2265),l=s(20271),o=s(94508),c=l.fC,d=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)(l.aV,(0,n._)({ref:t,className:(0,o.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s)},i))});d.displayName=l.aV.displayName;var u=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)(l.xz,(0,n._)({ref:t,className:(0,o.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s)},i))});u.displayName=l.xz.displayName;var m=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)(l.VY,(0,n._)({ref:t,className:(0,o.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s)},i))});m.displayName=l.VY.displayName}},function(e){e.O(0,[337,518,60,711,865,896,694,374,295,683,444,971,117,744],function(){return e(e.s=62852)}),_N_E=e.O()}]);