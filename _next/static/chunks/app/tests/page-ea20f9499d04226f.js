(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4396],{57837:function(e,t,s){Promise.resolve().then(s.bind(s,82830))},82830:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eo}});var n=s(57437),r=s(2265),a=s(99376),i=s(76362),c=s(93113),l=s(2403),o=s(5194),d=s(1780),u=s(50059),m=s(85735),h=s(5853),x=s(280),f=s(66070),p=s(62869),j=s(73578),g=s(95186),v=s(26937),N=s(73247),b=s(90740),y=s(48736),w=s(91723),_=s(15868),C=s(14438),S=s(12144);function k(e){var t,s=e.companyId,i=(0,a.useRouter)(),c=(0,u._)((0,r.useState)([]),2),k=c[0],T=c[1],E=(0,u._)((0,r.useState)(!0),2),Z=E[0],I=E[1],q=(0,u._)((0,r.useState)(""),2),z=q[0],O=q[1],A=(0,u._)((0,r.useState)(null),2),M=A[0],Q=A[1],F=(0,u._)((0,r.useState)(null),2),R=F[0],D=F[1],J=(0,u._)((0,r.useState)([]),2),P=J[0],L=J[1];(0,r.useEffect)(function(){function e(){return(e=(0,l._)(function(){var e,t,n,r,a;return(0,h.Jh)(this,function(i){switch(i.label){case 0:I(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),e=x.OQ.from("tests").select("\n            *,\n            companies:company_id (\n              name\n            )\n          ").order("created_at",{ascending:!1}),s&&(e=e.eq("company_id",s)),[4,e];case 2:if(n=(t=i.sent()).data,r=t.error)throw r;return T(a=n.map(function(e){var t;return(0,d._)((0,o._)({},e),{company_name:(null===(t=e.companies)||void 0===t?void 0:t.name)||"Unknown"})})),L((0,m._)(new Set(a.map(function(e){return e.category}))).filter(Boolean).sort()),[3,5];case 3:return console.error("Error fetching tests:",i.sent()),C.Am.error("Failed to load tests"),[3,5];case 4:return I(!1),[7];case 5:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[s]);var V=function(e){switch(e){case"Easy":default:return"⭐";case"Medium":return"⭐⭐";case"Advanced":return"⭐⭐⭐"}},Y=k.filter(function(e){var t=e.title.toLowerCase().includes(z.toLowerCase())||e.company_name.toLowerCase().includes(z.toLowerCase()),s=!M||e.complexity===M,n=!R||e.category===R;return t&&s&&n}),U=(t=(0,l._)(function(e){var t,s,n,r,a,i,c,l,o;return(0,h.Jh)(this,function(d){switch(d.label){case 0:if(!confirm("Are you sure you want to delete this test?"))return[2];d.label=1;case 1:return d.trys.push([1,11,,12]),[4,x.OQ.from("tests").delete().eq("id",e)];case 2:if(t=d.sent().error)throw t;return[4,x.OQ.storage.from("test-content").remove(["".concat(e,".json")])];case 3:(s=d.sent().error)&&console.error("Error deleting test content file:",s),d.label=4;case 4:if(d.trys.push([4,9,,10]),!(n=k.find(function(t){return t.id===e})))return[3,8];return r="chatbot-flow-".concat(n.company_id,".json"),[4,x.OQ.storage.from("test-flows").download(r)];case 5:if(i=(a=d.sent()).data,!(!a.error&&i))return[3,8];return[4,i.text()];case 6:if(c=JSON.parse(d.sent()),l=!1,c.nodes&&Object.keys(c.nodes).forEach(function(t){var s=c.nodes[t];s.questionSetId&&s.questionSetId.standard&&["easy","medium","Advanced"].forEach(function(t){if(Array.isArray(s.questionSetId.standard[t])){var n=s.questionSetId.standard[t].indexOf(e);-1!==n&&(s.questionSetId.standard[t].splice(n,1),l=!0)}})}),!l)return[3,8];return c.metadata.lastUpdated=new Date().toISOString(),[4,x.OQ.storage.from("test-flows").upload(r,new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),{upsert:!0})];case 7:(o=d.sent().error)&&console.error("Error updating flow after test deletion:",o),d.label=8;case 8:return[3,10];case 9:return console.error("Error updating flow references:",d.sent()),[3,10];case 10:return T(k.filter(function(t){return t.id!==e})),C.Am.success("Test deleted successfully"),[3,12];case 11:return console.error("Error deleting test:",d.sent()),C.Am.error("Failed to delete test"),[3,12];case 12:return[2]}})}),function(e){return t.apply(this,arguments)});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.Z,{items:[{label:"Companies",onClick:function(){return i.push("/companies?view=list")}}].concat((0,m._)(s?[{label:"Company Tests"}]:[{label:"All Tests"}]))}),(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:s?"Company Tests":"All Tests"}),s&&(0,n.jsxs)(p.z,{onClick:function(){return i.push("/tests?view=new&companyId=".concat(s))},className:"text-base",children:[(0,n.jsx)(v.Z,{className:"mr-2 h-5 w-5"}),"Create New Test"]})]}),(0,n.jsxs)(f.Zb,{children:[(0,n.jsx)(f.Ol,{className:"pb-2",children:(0,n.jsx)(f.ll,{className:"text-xl",children:"Tests"})}),(0,n.jsxs)(f.aY,{children:[(0,n.jsxs)("div",{className:"flex flex-col space-y-4 mb-4 md:flex-row md:space-y-0 md:space-x-4 md:items-center",children:[(0,n.jsxs)("div",{className:"relative flex-1",children:[(0,n.jsx)(N.Z,{className:"absolute left-2.5 top-3 h-4 w-4 text-gray-500"}),(0,n.jsx)(g.I,{type:"search",placeholder:"Search tests...",className:"pl-8 text-base h-10",value:z,onChange:function(e){return O(e.target.value)}})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(b.Z,{className:"h-4 w-4 text-gray-500"}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"Complexity:"}),(0,n.jsx)("div",{className:"flex space-x-1",children:["Easy","Medium","Advanced"].map(function(e){return(0,n.jsxs)(p.z,{variant:M===e?"default":"outline",size:"sm",onClick:function(){M===e?Q(null):Q(e)},className:"text-xs h-8",children:[V(e)," ",e]},e)})})]}),P.length>0&&(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"Category:"}),(0,n.jsxs)("select",{className:"text-sm p-1 border rounded",value:R||"",onChange:function(e){return D(e.target.value||null)},children:[(0,n.jsx)("option",{value:"",children:"All"}),P.map(function(e){return(0,n.jsx)("option",{value:e,children:e},e)})]})]})]}),Z?(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-current border-e-transparent align-[-0.125em] text-primary"}),(0,n.jsx)("p",{className:"mt-2 text-gray-500",children:"Loading tests..."})]}):0===Y.length?(0,n.jsxs)("div",{className:"text-center py-12 border rounded-md bg-gray-50",children:[(0,n.jsx)("p",{className:"text-gray-500 mb-4",children:0===k.length?"No tests found":"No tests match your search criteria"}),s&&(0,n.jsx)(p.z,{onClick:function(){return i.push("/tests?view=new&companyId=".concat(s))},children:"Create your first test"})]}):(0,n.jsxs)(j.iA,{children:[(0,n.jsx)(j.xD,{children:(0,n.jsxs)(j.SC,{children:[(0,n.jsx)(j.ss,{className:"w-[40%] text-base",children:"Test Title"}),!s&&(0,n.jsx)(j.ss,{className:"text-base",children:"Company"}),(0,n.jsx)(j.ss,{className:"text-base",children:"Complexity"}),(0,n.jsx)(j.ss,{className:"text-base",children:"Category"}),(0,n.jsx)(j.ss,{className:"text-base",children:"Time"}),(0,n.jsx)(j.ss,{className:"text-base",children:"Created"}),(0,n.jsx)(j.ss,{className:"text-base text-right",children:"Actions"})]})}),(0,n.jsx)(j.RM,{children:Y.map(function(e){var t;return(0,n.jsxs)(j.SC,{className:"cursor-pointer hover:bg-gray-50",onClick:function(){return i.push("/tests?view=detail&id=".concat(e.id,"&companyId=").concat(e.company_id))},children:[(0,n.jsx)(j.pj,{className:"font-medium text-base",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(y.Z,{className:"h-5 w-5 mr-2 text-gray-500"}),e.title]})}),!s&&(0,n.jsx)(j.pj,{className:"text-base",children:e.company_name}),(0,n.jsx)(j.pj,{className:"text-base",children:(0,n.jsx)("span",{title:e.complexity,children:V(e.complexity)})}),(0,n.jsx)(j.pj,{className:"text-base",children:e.category}),(0,n.jsx)(j.pj,{className:"text-base",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(w.Z,{className:"h-4 w-4 mr-1 text-gray-500"}),(t=e.time_limit,"".concat(Math.floor(t/60)," min"))]})}),(0,n.jsx)(j.pj,{className:"text-base",children:new Date(e.created_at).toLocaleDateString()}),(0,n.jsxs)(j.pj,{className:"text-right",children:[(0,n.jsxs)(p.z,{variant:"ghost",size:"sm",onClick:function(t){t.stopPropagation(),i.push("/tests?view=edit&id=".concat(e.id,"&companyId=").concat(e.company_id))},children:[(0,n.jsx)(_.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Edit"})]}),(0,n.jsxs)(p.z,{variant:"ghost",size:"sm",onClick:function(t){t.stopPropagation(),U(e.id)},children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,n.jsx)("span",{className:"sr-only",children:"Delete"})]})]})]},e.id)})})]})]})]})]})}var T=s(26815),E=s(12339),Z=s(53647),I=s(76818),q=s(962),z=q.fC,O=q.wy,A=q.Fw,M=s(51817),Q=s(83229),F=s(40875),R=s(27413),D=s(76865),J=s(3974),P=s(32660),L=s(92451),V=s(10407),Y=s(82431),U=s(48614),B=s(40521),W=s(57970),H=s(11411),X=s.n(H),K=s(81103),G=s(65613),$=s(46796),ee=s(50721),et=s(94508),es=r.forwardRef(function(e,t){var s=e.className,r=(0,$._)(e,["className"]);return(0,n.jsx)(ee.fC,(0,d._)((0,o._)({className:(0,et.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s)},r),{ref:t,children:(0,n.jsx)(ee.bU,{className:(0,et.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}))});es.displayName=ee.fC.displayName;var en=s(26110),er=["i.postimg.cc","i.imgur.com","miro.medium.com","cdn-images-1.medium.com"],ea=["Easy","Medium","Advanced"];function ei(e){var t,s,i,c,v,N,b,y,k,q=e.testId,H=e.companyId,$=e.user,ee=(0,a.useRouter)(),et=!!q,ei=(0,u._)((0,r.useState)(null),2),ec=ei[0],el=ei[1],eo=(0,u._)((0,r.useState)(""),2),ed=eo[0],eu=eo[1],em=(0,u._)((0,r.useState)(""),2),eh=em[0],ex=em[1],ef=(0,u._)((0,r.useState)(900),2),ep=ef[0],ej=ef[1],eg=(0,u._)((0,r.useState)("Medium"),2),ev=eg[0],eN=eg[1],eb=(0,u._)((0,r.useState)(""),2),ey=eb[0],ew=eb[1],e_=(0,u._)((0,r.useState)(""),2),eC=e_[0],eS=e_[1],ek=(0,u._)((0,r.useState)(!0),2),eT=ek[0],eE=ek[1],eZ=(0,u._)((0,r.useState)(!1),2),eI=eZ[0],eq=eZ[1],ez=(0,u._)((0,r.useState)("menu"),2),eO=ez[0],eA=ez[1],eM=(0,u._)((0,r.useState)([]),2),eQ=eM[0],eF=eM[1],eR=(0,u._)((0,r.useState)(!1),2),eD=(eR[0],eR[1]),eJ=(0,u._)((0,r.useState)(0),2),eP=(eJ[0],eJ[1]),eL=(0,u._)((0,r.useState)([]),2),eV=eL[0],eY=eL[1],eU=(0,u._)((0,r.useState)(null),2),eB=eU[0],eW=eU[1],eH=(0,u._)((0,r.useState)(0),2),eX=eH[0],eK=eH[1],eG=(0,u._)((0,r.useState)(!1),2);eG[0],eG[1];var e$=(0,u._)((0,r.useState)(null),2),e0=e$[0],e1=e$[1],e2=(0,u._)((0,r.useState)([]),2),e4=e2[0],e3=e2[1],e5=(0,u._)((0,r.useState)(""),2),e6=e5[0],e7=e5[1],e8=(0,u._)((0,r.useState)([]),2),e9=e8[0],te=e8[1],tt=(0,u._)((0,r.useState)(null),2),ts=tt[0],tn=tt[1],tr=(0,u._)((0,r.useState)([]),2),ta=tr[0],ti=tr[1],tc=(0,u._)((0,r.useState)(!1),2),tl=tc[0],to=tc[1],td=(0,u._)((0,r.useState)(null),2),tu=td[0],tm=td[1];(0,r.useEffect)(function(){function e(){return(e=(0,l._)(function(){var e,t,s,n,r,a,i,c,l,o;return(0,h.Jh)(this,function(d){switch(d.label){case 0:eE(!0),d.label=1;case 1:return d.trys.push([1,8,9,10]),[4,x.OQ.from("companies").select("id, name").eq("id",H).single()];case 2:if(t=(e=d.sent()).data,s=e.error)throw s;return el(t),[4,x.OQ.from("test_menus").select("id, menu_text, menu_json").eq("company_id",H).order("created_at",{ascending:!1}).limit(1)];case 3:return r=(n=d.sent()).data,!n.error&&r.length>0&&(e7(r[0].menu_text),te(r[0].menu_json),tn(r[0].id)),[4,x.OQ.from("tests").select("*").eq("company_id",H)];case 4:if(i=(a=d.sent()).data,!a.error&&i&&e3(i),!(et&&q))return[3,6];return[4,x.OQ.from("tests").select("*").eq("id",q).single()];case 5:if(l=(c=d.sent()).data,o=c.error)throw o;return eu(l.id),ex(l.title),ej(l.time_limit),eN(l.complexity),ew(l.category),eS(l.markdown_content||""),e1(l),eA("test"),[3,7];case 6:eu("TEST-".concat(Math.random().toString(36).substring(2,8).toUpperCase())),d.label=7;case 7:return[3,10];case 8:return console.error("Error loading data:",d.sent()),C.Am.error("Failed to load data"),[3,10];case 9:return eE(!1),[7];case 10:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[H,q,et]);var th=function(e){var t=e.split("\n"),s=[],n=null;return t.forEach(function(e){var t=e.trim();if(t.startsWith("-")&&!t.startsWith("--"))n={category:t.substring(1).trim(),tests:[]},s.push(n);else if(t.startsWith("--")&&n){var r=t.substring(2).trim().split(" "),a=r[0],i=r.slice(1).join(" "),c=e4.find(function(e){return e.id===a});n.tests.push({id:a,name:i,isEnabled:!c||c.is_enabled})}}),s};(0,r.useEffect)(function(){te(th(e6))},[e6,e4]);var tx=(t=(0,l._)(function(){var e,t,s,n,r;return(0,h.Jh)(this,function(a){switch(a.label){case 0:if(!e6.trim())return C.Am.error("Menu text cannot be empty"),[2];eq(!0),a.label=1;case 1:if(a.trys.push([1,6,7,8]),e=th(e6),!ts)return[3,3];return[4,x.OQ.from("test_menus").update({menu_text:e6,menu_json:e,updated_at:new Date().toISOString(),last_modified_by:$.id}).eq("id",ts)];case 2:if(t=a.sent().error)throw t;return[3,5];case 3:return[4,x.OQ.from("test_menus").insert({company_id:H,menu_text:e6,menu_json:e,last_modified_by:$.id}).select()];case 4:if(n=(s=a.sent()).data,r=s.error)throw r;n&&n.length>0&&tn(n[0].id),a.label=5;case 5:return C.Am.success("Menu saved successfully"),[3,8];case 6:return console.error("Error saving menu:",a.sent()),C.Am.error("Failed to save menu"),[3,8];case 7:return eq(!1),[7];case 8:return[2]}})}),function(){return t.apply(this,arguments)}),tf=function(e){ti(function(t){return t.includes(e)?t.filter(function(t){return t!==e}):(0,m._)(t).concat([e])})},tp=(s=(0,l._)(function(e){var t,s,n;return(0,h.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,x.OQ.from("tests").select("*").eq("id",e).single()];case 1:if(s=(t=r.sent()).data,n=t.error)throw n;return eu(s.id),ex(s.title),ej(s.time_limit),eN(s.complexity),ew(s.category),eS(s.markdown_content||""),e1(s),eA("test"),[3,3];case 2:return console.error("Error loading test:",r.sent()),C.Am.error("Failed to load test"),[3,3];case 3:return[2]}})}),function(e){return s.apply(this,arguments)}),tj=(i=(0,l._)(function(e,t){var s;return(0,h.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,x.OQ.from("tests").update({is_enabled:t}).eq("id",e)];case 1:if(s=n.sent().error)throw s;return e3(function(s){return s.map(function(s){return s.id===e?(0,d._)((0,o._)({},s),{is_enabled:t}):s})}),C.Am.success("Test ".concat(t?"enabled":"disabled"," successfully")),[3,3];case 2:return console.error("Error updating test status:",n.sent()),C.Am.error("Failed to update test status"),[3,3];case 3:return[2]}})}),function(e,t){return i.apply(this,arguments)}),tg=function(e){tm(e),to(!0)},tv=(c=(0,l._)(function(){var e;return(0,h.Jh)(this,function(t){switch(t.label){case 0:if(!tu)return[2];t.label=1;case 1:return t.trys.push([1,4,5,6]),[4,x.OQ.from("tests").delete().eq("id",tu)];case 2:if(e=t.sent().error)throw e;return e3(function(e){return e.filter(function(e){return e.id!==tu})}),e7(e6.split("\n").filter(function(e){return!e.includes(tu)}).join("\n")),[4,tx()];case 3:return t.sent(),C.Am.success("Test deleted successfully"),[3,6];case 4:return console.error("Error deleting test:",t.sent()),C.Am.error("Failed to delete test"),[3,6];case 5:return to(!1),tm(null),[7];case 6:return[2]}})}),function(){return c.apply(this,arguments)}),tN=(v=(0,l._)(function(e){var t,s,n;return(0,h.Jh)(this,function(r){switch(r.label){case 0:t=[],eD(!0),eP(0),r.label=1;case 1:return r.trys.push([1,3,4,5]),e.length>5e3&&t.push({type:"error",message:"Content exceeds ".concat(5e3," characters limit")}),(s=e.split("---").filter(function(e){return e.trim()})).length>30&&t.push({type:"error",message:"Too many questions (".concat(s.length,"/").concat(30,")")}),s.forEach(function(e,s){e.trim()||t.push({type:"error",message:"Empty question found at position ".concat(s+1)})}),[4,tb(e)];case 2:return(n=r.sent()).length>0&&t.push({type:"warning",message:"".concat(n.length," image(s) have issues")}),eP(100),[2,t];case 3:return console.error("Validation error:",r.sent()),[2,[{type:"error",message:"Validation failed unexpectedly"}]];case 4:return eD(!1),[7];case 5:return[2]}})}),function(e){return v.apply(this,arguments)}),tb=(N=(0,l._)(function(e){var t,s,n,r,a,i,c,l,o,d,u;return(0,h.Jh)(this,function(m){switch(m.label){case 0:for(console.log("[IMAGE_CHECK] Starting image URL check on content"),t=/!\[.*?\]\((.*?)\)/g,s=[];null!==(n=t.exec(e));)n[1]&&s.push(n[1].trim());r=[],a=!0,i=!1,c=void 0,m.label=1;case 1:m.trys.push([1,6,7,8]),l=function(){var e,t;return(0,h.Jh)(this,function(s){switch(s.label){case 0:e=d.value,s.label=1;case 1:if(s.trys.push([1,3,,4]),t=new URL(e).hostname,!er.includes(t))return r.push("".concat(e," (untrusted domain: ").concat(t,")")),[2,"continue"];return[4,new Promise(function(t){var s=new Image;s.onload=function(){return t(!0)},s.onerror=function(){return t(!1)},s.src=e,setTimeout(function(){return t(!1)},5e3)})];case 2:return s.sent()||r.push("".concat(e," (cannot be loaded)")),[3,4];case 3:return s.sent(),r.push("".concat(e," (invalid URL format)")),[3,4];case 4:return[2]}})},o=s[Symbol.iterator](),m.label=2;case 2:if(a=(d=o.next()).done)return[3,5];return[5,(0,h.XA)(l())];case 3:m.sent(),m.label=4;case 4:return a=!0,[3,2];case 5:return[3,8];case 6:return u=m.sent(),i=!0,c=u,[3,8];case 7:try{a||null==o.return||o.return()}finally{if(i)throw c}return[7];case 8:return eY(r),[2,r]}})}),function(e){return N.apply(this,arguments)}),ty=(b=(0,l._)(function(){var e;return(0,h.Jh)(this,function(t){switch(t.label){case 0:if(!eC)return C.Am.error("No content to preview"),[2];return[4,tN(eC)];case 1:return eF(e=t.sent()),(0===e.length||e.every(function(e){return"warning"===e.type}))&&(eW({id:ed,title:eh,time_limit:ep,questions:eC.split("---").map(function(e,t){return{id:"q".concat(t+1),question:e.trim()}}).filter(function(e){return e.question.length>0})}),eK(0)),[2]}})}),function(){return b.apply(this,arguments)}),tw=(y=(0,l._)(function(){var e,t,s,n,r,a,i,c,l;return(0,h.Jh)(this,function(u){switch(u.label){case 0:if(!eh||!eC||!ey)return C.Am.error("Please fill in all required fields"),[2];eq(!0),u.label=1;case 1:if(u.trys.push([1,8,9,10]),e={id:ed,title:eh,time_limit:ep,questions:eC.split("---").map(function(e,t){return{id:"q".concat(t+1),question:e.trim()}}).filter(function(e){return e.question.length>0})},t={id:ed,company_id:H,title:eh,category:ey,complexity:ev,time_limit:ep,markdown_content:eC,json_content:e,is_enabled:!0,created_by:$.id,last_modified_by:$.id},!e0)return[3,3];return[4,x.OQ.from("tests").update((0,d._)((0,o._)({},t),{updated_at:new Date().toISOString()})).eq("id",ed)];case 2:if(s=u.sent().error)throw s;return[3,6];case 3:return[4,x.OQ.from("tests").insert([t])];case 4:if(n=u.sent().error)throw n;if(r=e6.includes("-".concat(ey)),e6.includes("--".concat(ed)))return[3,6];if(a=e6,r){if(-1!==(c=(i=a.split("\n")).findIndex(function(e){return e.trim()==="-".concat(ey)||e.trim()==="-".concat(ey)}))){for(l=c+1;l<i.length&&i[l].trim().startsWith("--");)l++;i.splice(l,0,"--".concat(ed," ").concat(eh)),a=i.join("\n")}}else a+="\n-".concat(ey,"\n--").concat(ed," ").concat(eh);return e7(a),[4,tx()];case 5:u.sent(),u.label=6;case 6:return[4,x.OQ.from("test_history").insert([{test_id:ed,action:e0?"updated":"created",markdown_content:eC,json_content:e,performed_by:$.id}])];case 7:return u.sent(),e0?e3(function(e){return e.map(function(e){return e.id===ed?(0,o._)({},e,t):e})}):e3(function(e){return(0,m._)(e).concat([t])}),C.Am.success(e0?"Test updated successfully":"Test created successfully"),eA("menu"),[3,10];case 8:return console.error("Error saving test:",u.sent()),C.Am.error("Failed to save test"),[3,10];case 9:return eq(!1),[7];case 10:return[2]}})}),function(){return y.apply(this,arguments)});return eT?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.Z,{items:[{label:"Companies",onClick:function(){return ee.push("/companies?view=list")}},{label:"Loading..."}]}),(0,n.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,n.jsx)(M.Z,{className:"h-8 w-8 animate-spin text-primary"}),(0,n.jsx)("span",{className:"ml-2 text-lg",children:"Loading..."})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.Z,{items:[{label:"Companies",onClick:function(){return ee.push("/companies?view=list")}},{label:(null==ec?void 0:ec.name)||"",onClick:function(){return ee.push("/companies?view=detail&id=".concat(H))}},{label:et?"Edit Test":"Test Manager"}]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-2",children:et?"Edit Test":"Test Manager"}),(0,n.jsx)("p",{className:"text-gray-500",children:"Manage test menu structure, create and edit tests"})]}),(0,n.jsxs)(E.mQ,{value:eO,onValueChange:eA,children:[(0,n.jsxs)(E.dr,{className:"mb-4",children:[(0,n.jsx)(E.SP,{value:"menu",children:"Test Menu"}),(0,n.jsx)(E.SP,{value:"test",children:"Test Editor"}),(0,n.jsx)(E.SP,{value:"preview",children:"Preview"})]}),(0,n.jsx)(E.nU,{value:"menu",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,n.jsxs)(f.Zb,{children:[(0,n.jsxs)(f.Ol,{children:[(0,n.jsx)(f.ll,{children:"Menu Structure"}),(0,n.jsxs)(f.SZ,{children:["Define your test menu structure using the format:",(0,n.jsx)("br",{}),(0,n.jsx)("code",{children:"-Category"})," for categories and ",(0,n.jsx)("code",{children:"--TEST-ID Test Name"})," for tests"]})]}),(0,n.jsxs)(f.aY,{children:[(0,n.jsx)(I.g,{value:e6,onChange:function(e){return e7(e.target.value)},placeholder:"-ML ENGINEER --TEST-ML-001 Mathematics --TEST-ML-002 Algorithms -WEB DEVELOPMENT --TEST-WEB-001 JavaScript",className:"font-mono h-80"}),(0,n.jsxs)("div",{className:"flex justify-between mt-2 text-xs text-muted-foreground",children:[(0,n.jsxs)("span",{children:[e6.length,"/",2e3," characters"]}),(0,n.jsxs)("span",{children:[e6.split("\n").length,"/",100," lines"]})]})]}),(0,n.jsx)(f.eW,{children:(0,n.jsx)(p.z,{onClick:tx,disabled:eI||!e6.trim(),className:"w-full",children:eI?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(M.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Q.Z,{className:"mr-2 h-4 w-4"}),"Save Menu"]})})})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)(f.Zb,{children:[(0,n.jsxs)(f.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(f.ll,{children:"Menu Preview"}),(0,n.jsx)(f.SZ,{children:"Visual representation of your test menu"})]}),(0,n.jsx)(p.z,{onClick:function(){eu("TEST-".concat(Math.random().toString(36).substring(2,8).toUpperCase())),ex(""),ej(900),eN("Medium"),ew(""),eS(""),e1(null),eA("test")},children:"Create New Test"})]}),(0,n.jsx)(f.aY,{children:e9.length>0?(0,n.jsx)("div",{className:"space-y-2",children:e9.map(function(e){return(0,n.jsxs)(z,{open:ta.includes(e.category),onOpenChange:function(){return tf(e.category)},className:"border rounded-md",children:[(0,n.jsxs)("div",{className:"flex items-center p-2 bg-muted/30",children:[(0,n.jsx)(O,{asChild:!0,children:(0,n.jsx)(p.z,{variant:"ghost",size:"sm",className:"p-1",children:(0,n.jsx)(F.Z,{className:"h-4 w-4"})})}),(0,n.jsx)("span",{className:"font-medium",children:e.category})]}),(0,n.jsx)(A,{children:(0,n.jsx)("div",{className:"p-2 space-y-2",children:e.tests.length>0?e.tests.map(function(e){return(0,n.jsxs)("div",{className:"flex items-center justify-between p-2 border rounded bg-background",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("span",{className:"text-sm font-mono",children:e.id}),(0,n.jsx)("span",{className:"text-sm",children:e.name})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(K.pn,{children:(0,n.jsxs)(K.u,{children:[(0,n.jsx)(K.aJ,{asChild:!0,children:(0,n.jsx)(es,{checked:e.isEnabled,onCheckedChange:function(t){return tj(e.id,t)}})}),(0,n.jsx)(K._v,{children:e.isEnabled?"Enabled":"Disabled"})]})}),(0,n.jsx)(K.pn,{children:(0,n.jsxs)(K.u,{children:[(0,n.jsx)(K.aJ,{asChild:!0,children:(0,n.jsx)(p.z,{variant:"ghost",size:"icon",onClick:function(){return tp(e.id)},children:(0,n.jsx)(_.Z,{className:"h-4 w-4"})})}),(0,n.jsx)(K._v,{children:"Edit Test"})]})}),(0,n.jsx)(K.pn,{children:(0,n.jsxs)(K.u,{children:[(0,n.jsx)(K.aJ,{asChild:!0,children:(0,n.jsx)(p.z,{variant:"ghost",size:"icon",onClick:function(){return tg(e.id)},children:(0,n.jsx)(R.Z,{className:"h-4 w-4"})})}),(0,n.jsx)(K._v,{children:"Delete Test"})]})})]})]},e.id)}):(0,n.jsx)("div",{className:"text-center p-4 text-muted-foreground",children:"No tests in this category"})})})]},e.category)})}):(0,n.jsxs)("div",{className:"text-center p-8 text-muted-foreground",children:[(0,n.jsx)("p",{children:"No menu structure defined yet"}),(0,n.jsx)("p",{className:"text-sm mt-2",children:"Add categories and tests in the menu editor"})]})})]}),(0,n.jsxs)(f.Zb,{children:[(0,n.jsxs)(f.Ol,{children:[(0,n.jsx)(f.ll,{children:"All Tests"}),(0,n.jsx)(f.SZ,{children:"View and manage all tests in your company"})]}),(0,n.jsx)(f.aY,{children:e4.length>0?(0,n.jsxs)(j.iA,{children:[(0,n.jsx)(j.xD,{children:(0,n.jsxs)(j.SC,{children:[(0,n.jsx)(j.ss,{children:"ID"}),(0,n.jsx)(j.ss,{children:"Title"}),(0,n.jsx)(j.ss,{children:"Category"}),(0,n.jsx)(j.ss,{children:"Status"}),(0,n.jsx)(j.ss,{className:"text-right",children:"Actions"})]})}),(0,n.jsx)(j.RM,{children:e4.map(function(e){return(0,n.jsxs)(j.SC,{children:[(0,n.jsx)(j.pj,{className:"font-mono text-xs",children:e.id}),(0,n.jsx)(j.pj,{className:"max-w-[200px] truncate",children:e.title}),(0,n.jsx)(j.pj,{children:e.category}),(0,n.jsx)(j.pj,{children:(0,n.jsx)(es,{checked:e.is_enabled,onCheckedChange:function(t){return tj(e.id,t)}})}),(0,n.jsx)(j.pj,{className:"text-right",children:(0,n.jsx)(p.z,{variant:"ghost",size:"sm",onClick:function(){return tp(e.id)},children:"Edit"})})]},e.id)})})]}):(0,n.jsxs)("div",{className:"text-center p-8 text-muted-foreground",children:[(0,n.jsx)("p",{children:"No tests created yet"}),(0,n.jsx)("p",{className:"text-sm mt-2",children:"Create your first test to get started"})]})})]})]})]})}),(0,n.jsx)(E.nU,{value:"test",children:(0,n.jsxs)(f.Zb,{children:[(0,n.jsxs)(f.Ol,{children:[(0,n.jsx)(f.ll,{children:e0?"Edit Test: ".concat(e0.id):"Create New Test"}),(0,n.jsx)(f.SZ,{children:"Define test details and questions"})]}),(0,n.jsx)(f.aY,{children:(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(T._,{htmlFor:"test-id",children:"Test ID"}),(0,n.jsx)(g.I,{id:"test-id",value:ed,onChange:function(e){return eu(e.target.value)},disabled:!!e0,className:"font-mono"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(T._,{htmlFor:"test-title",children:"Test Title"}),(0,n.jsx)(g.I,{id:"test-title",value:eh,onChange:function(e){return ex(e.target.value)},placeholder:"e.g., Machine Learning Basics"})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(T._,{htmlFor:"category",children:"Category"}),(0,n.jsxs)(Z.Ph,{value:ey,onValueChange:ew,children:[(0,n.jsx)(Z.i4,{id:"category",children:(0,n.jsx)(Z.ki,{placeholder:"Select category"})}),(0,n.jsx)(Z.Bw,{children:e9.map(function(e){return e.category}).map(function(e){return(0,n.jsx)(Z.Ql,{value:e,children:e},e)})})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(T._,{htmlFor:"complexity",children:"Complexity"}),(0,n.jsxs)(Z.Ph,{value:ev,onValueChange:eN,children:[(0,n.jsx)(Z.i4,{id:"complexity",children:(0,n.jsx)(Z.ki,{placeholder:"Select complexity"})}),(0,n.jsx)(Z.Bw,{children:ea.map(function(e){return(0,n.jsx)(Z.Ql,{value:e,children:e},e)})})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(T._,{htmlFor:"time-limit",children:"Time Limit (minutes)"}),(0,n.jsx)(g.I,{id:"time-limit",type:"number",value:ep/60,onChange:function(e){return ej(60*parseInt(e.target.value))},min:1,max:180})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsx)(T._,{htmlFor:"markdown-content",children:"Test Questions"}),(0,n.jsx)("span",{className:"text-xs text-muted-foreground",children:'Separate questions with "---"'})]}),(0,n.jsx)(I.g,{id:"markdown-content",value:eC,onChange:function(e){return eS(e.target.value)},className:"font-mono min-h-[400px]",placeholder:"# Question 1  Your question content here  ---  # Question 2",onPaste:function(e){var t=e.clipboardData.getData("text");if(t.trim().startsWith("http")){var s=/(jpg|jpeg|png|gif|webp|svg)/i.test(t),n=/(image|photo|picture)/i.test(t);if(s||n){e.preventDefault();var r=e.currentTarget,a=r.selectionStart||0,i=r.value.substring(0,a),c=r.value.substring(a),l="![](".concat(t.trim(),")");eS(i+l+c),setTimeout(function(){r.selectionStart=a+l.length,r.selectionEnd=a+l.length},0),C.Am.success("URL converted to markdown image format")}}}}),(0,n.jsxs)("div",{className:"flex justify-between mt-2 text-xs text-muted-foreground",children:[(0,n.jsxs)("span",{children:[eC.length,"/",5e3," characters"]}),(0,n.jsxs)("span",{children:[eC.split("---").filter(function(e){return e.trim()}).length,"/",30," questions"]})]})]}),eQ.length>0&&(0,n.jsxs)(G.bZ,{variant:eQ.some(function(e){return"error"===e.type})?"destructive":"default",children:[(0,n.jsx)(D.Z,{className:"h-4 w-4"}),(0,n.jsx)(G.Cd,{children:"Validation Issues"}),(0,n.jsx)(G.X,{children:(0,n.jsx)("ul",{className:"list-disc pl-5 mt-2",children:eQ.map(function(e,t){return(0,n.jsx)("li",{children:e.message},t)})})})]}),eV.length>0&&(0,n.jsxs)(G.bZ,{variant:"default",children:[(0,n.jsx)(J.Z,{className:"h-4 w-4"}),(0,n.jsx)(G.Cd,{children:"Image Issues"}),(0,n.jsxs)(G.X,{children:[(0,n.jsx)("p",{children:"The following images have issues:"}),(0,n.jsx)("ul",{className:"list-disc pl-5 mt-2 text-sm",children:eV.map(function(e,t){return(0,n.jsx)("li",{className:"break-all",children:e},t)})})]})]})]})}),(0,n.jsxs)(f.eW,{className:"flex justify-between",children:[(0,n.jsxs)(p.z,{variant:"outline",onClick:function(){return eA("menu")},children:[(0,n.jsx)(P.Z,{className:"mr-2 h-4 w-4"}),"Back to Menu"]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)(p.z,{variant:"outline",onClick:ty,disabled:!eC.trim(),children:"Preview"}),(0,n.jsx)(p.z,{onClick:tw,disabled:eI||!eh||!ey||!eC.trim()||eQ.some(function(e){return"error"===e.type}),children:eI?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(M.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Q.Z,{className:"mr-2 h-4 w-4"}),e0?"Update Test":"Create Test"]})})]})]})]})}),(0,n.jsx)(E.nU,{value:"preview",children:(0,n.jsxs)(f.Zb,{children:[(0,n.jsxs)(f.Ol,{className:"py-3 px-4 border-b flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,n.jsx)("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 border border-blue-200",children:ev}),ey&&(0,n.jsx)("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full bg-gray-50 text-gray-700 border border-gray-200",children:ey})]}),(0,n.jsx)("h1",{className:"text-lg font-semibold",children:eh||"Test Preview"})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(w.Z,{className:"h-4 w-4 mr-1"}),(0,n.jsxs)("span",{className:"text-sm font-medium",children:[ep/60," minutes"]})]})]}),(0,n.jsx)(f.aY,{className:"p-0",children:eB&&eB.questions.length>0?(0,n.jsx)("div",{className:"flex flex-col h-[600px]",children:(0,n.jsx)(U.M,{mode:"wait",children:(0,n.jsxs)(B.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"flex-grow flex flex-col p-4 overflow-auto",children:[(0,n.jsx)("div",{className:"flex items-center mb-2",children:(0,n.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Question ",eX+1," of ",eB.questions.length]})}),(0,n.jsx)("div",{className:"flex-grow overflow-y-auto mb-4",children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:X().sanitize(W.TU.parse((null===(k=eB.questions[eX])||void 0===k?void 0:k.question)||"",{async:!1}))},className:"prose prose-sm max-w-none dark:prose-invert"})}),(0,n.jsxs)("div",{className:"flex justify-between mt-auto pt-2 border-t",children:[(0,n.jsxs)(p.z,{onClick:function(){eK(function(e){return Math.max(0,e-1)})},disabled:0===eX,variant:"ghost",size:"sm",className:"text-xs",children:[(0,n.jsx)(L.Z,{className:"mr-1 h-4 w-4"})," Previous"]}),(0,n.jsxs)(p.z,{onClick:function(){eB&&eK(function(e){return Math.min(eB.questions.length-1,e+1)})},disabled:eX===eB.questions.length-1,variant:"ghost",size:"sm",className:"text-xs",children:["Next ",(0,n.jsx)(V.Z,{className:"ml-1 h-4 w-4"})]})]})]},eX)})}):(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-[600px] text-center p-6",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)(Y.Z,{className:"h-10 w-10 text-muted-foreground mx-auto mb-2"}),(0,n.jsx)("h3",{className:"text-lg font-medium",children:"No Preview Available"})]}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground max-w-md",children:'Write your questions in the editor and click "Preview" to see how they will appear.'})]})}),(0,n.jsxs)(f.eW,{className:"flex justify-between",children:[(0,n.jsxs)(p.z,{variant:"outline",onClick:function(){return eA("test")},children:[(0,n.jsx)(P.Z,{className:"mr-2 h-4 w-4"}),"Back to Editor"]}),(0,n.jsx)(p.z,{onClick:tw,disabled:eI||!eh||!ey||!eC.trim()||eQ.some(function(e){return"error"===e.type}),children:eI?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(M.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Q.Z,{className:"mr-2 h-4 w-4"}),e0?"Update Test":"Create Test"]})})]})]})})]}),(0,n.jsx)(en.Vq,{open:tl,onOpenChange:to,children:(0,n.jsxs)(en.cZ,{children:[(0,n.jsxs)(en.fK,{children:[(0,n.jsx)(en.$N,{children:"Confirm Deletion"}),(0,n.jsx)(en.Be,{children:"Are you sure you want to delete this test? This action cannot be undone."})]}),(0,n.jsxs)(en.cN,{children:[(0,n.jsx)(p.z,{variant:"outline",onClick:function(){return to(!1)},children:"Cancel"}),(0,n.jsx)(p.z,{variant:"destructive",onClick:tv,children:"Delete"})]})]})})]})}function ec(e){var t,s,i,c=e.testId,m=(0,a.useRouter)(),j=(0,u._)((0,r.useState)(null),2),g=j[0],v=j[1],N=(0,u._)((0,r.useState)([]),2),b=N[0],y=N[1],k=(0,u._)((0,r.useState)(0),2),T=k[0],E=k[1],Z=(0,u._)((0,r.useState)(!0),2),I=Z[0],q=Z[1],z=(0,u._)((0,r.useState)(""),2),O=z[0];return(z[1],(0,r.useEffect)(function(){function e(){return(e=(0,l._)(function(){var e,t,s,n,r,a,i;return(0,h.Jh)(this,function(l){switch(l.label){case 0:q(!0),l.label=1;case 1:return l.trys.push([1,5,6,7]),[4,x.OQ.from("tests").select("\n            *,\n            companies:company_id (\n              name\n            )\n          ").eq("id",c).single()];case 2:if(s=(t=l.sent()).data,n=t.error)throw n;return v((0,d._)((0,o._)({},s),{company_name:(null===(e=s.companies)||void 0===e?void 0:e.name)||"Unknown"})),[4,x.OQ.storage.from("test-content").download("".concat(c,".json"))];case 3:if(a=(r=l.sent()).data,i=r.error)throw i;return[4,a.text()];case 4:return y(JSON.parse(l.sent()).questions||[]),[3,7];case 5:return console.error("Error fetching test:",l.sent()),C.Am.error("Failed to load test details"),[3,7];case 6:return q(!1),[7];case 7:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[c]),I)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.Z,{items:[{label:"Companies",onClick:function(){return m.push("/companies?view=list")}},{label:"Loading..."}]}),(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-current border-e-transparent align-[-0.125em] text-primary"}),(0,n.jsx)("p",{className:"mt-2 text-gray-500",children:"Loading test details..."})]})]}):g?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.Z,{items:[{label:"Companies",onClick:function(){return m.push("/companies?view=list")}},{label:g.company_name,onClick:function(){return m.push("/companies?view=detail&id=".concat(g.company_id))}},{label:g.title}]}),(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-1",children:g.title}),(0,n.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"mr-1",children:function(e){switch(e){case"Easy":default:return"⭐";case"Medium":return"⭐⭐";case"Advanced":return"⭐⭐⭐"}}(g.complexity)}),(0,n.jsx)("span",{children:g.complexity})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(w.Z,{className:"h-4 w-4 mr-1"}),(0,n.jsx)("span",{children:(t=g.time_limit,"".concat(Math.floor(t/60),":").concat((t%60).toString().padStart(2,"0")))})]}),(0,n.jsx)("div",{children:g.category})]})]}),(0,n.jsxs)("div",{className:"flex space-x-3",children:[(0,n.jsxs)(p.z,{variant:"outline",onClick:function(){return m.push("/companies?view=detail&id=".concat(g.company_id))},children:[(0,n.jsx)(P.Z,{className:"mr-2 h-4 w-4"}),"Back"]}),(0,n.jsxs)(p.z,{onClick:function(){return m.push("/tests?view=edit&id=".concat(c,"&companyId=").concat(g.company_id))},children:[(0,n.jsx)(_.Z,{className:"mr-2 h-4 w-4"}),"Edit Test"]})]})]}),0===b.length?(0,n.jsx)(f.Zb,{children:(0,n.jsx)(f.aY,{className:"py-12 text-center",children:(0,n.jsx)("p",{className:"text-gray-500",children:"No questions found in this test"})})}):(0,n.jsxs)(f.Zb,{className:"mb-6",children:[(0,n.jsx)(f.Ol,{className:"pb-0",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(f.ll,{className:"text-xl",children:"Question Preview"}),(0,n.jsxs)("div",{className:"text-sm text-gray-500",children:["Question ",T+1," of ",b.length]})]})}),(0,n.jsx)(f.aY,{className:"py-6",children:(0,n.jsx)("div",{className:"prose prose-gray max-w-none",children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:(s=b[T].question,i=W.TU.parse(s),X().sanitize(i))}})})}),(0,n.jsxs)(f.eW,{className:"flex justify-between py-4 border-t",children:[(0,n.jsxs)(p.z,{variant:"outline",size:"sm",onClick:function(){T>0&&E(function(e){return e-1})},disabled:0===T,children:[(0,n.jsx)(L.Z,{className:"mr-1 h-4 w-4"}),"Previous"]}),(0,n.jsxs)(p.z,{variant:"outline",size:"sm",onClick:function(){T<b.length-1&&E(function(e){return e+1})},disabled:T===b.length-1,children:["Next",(0,n.jsx)(V.Z,{className:"ml-1 h-4 w-4"})]})]})]}),(0,n.jsxs)("div",{className:"mt-6",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Markdown Source"}),(0,n.jsx)(f.Zb,{children:(0,n.jsx)(f.aY,{className:"p-4",children:(0,n.jsx)("pre",{className:"bg-gray-50 p-4 rounded-md overflow-auto max-h-96 text-sm font-mono",children:O})})})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.Z,{items:[{label:"Companies",onClick:function(){return m.push("/companies?view=list")}},{label:"Test Not Found"}]}),(0,n.jsxs)("div",{className:"text-center py-12 border rounded-md bg-gray-50",children:[(0,n.jsx)("p",{className:"text-gray-500 mb-4",children:"Test not found"}),(0,n.jsx)(p.z,{variant:"outline",onClick:function(){return m.push("/companies?view=list")},children:"Back to Companies"})]})]})}function el(){var e=(0,i.a)(),t=e.user,s=e.loading,r=(0,a.useRouter)(),c=(0,a.useSearchParams)(),l=c.get("view")||"list",o=c.get("id"),d=c.get("companyId");return s?(0,n.jsx)("div",{children:"Loading..."}):t?(0,n.jsxs)(n.Fragment,{children:["list"===l&&(0,n.jsx)(k,{companyId:d}),"new"===l&&d&&(0,n.jsx)(ei,{companyId:d,user:t}),"edit"===l&&o&&d&&(0,n.jsx)(ei,{testId:o,companyId:d,user:t}),"detail"===l&&o&&(0,n.jsx)(ec,{testId:o})]}):(r.push("/login"),null)}function eo(){return(0,n.jsx)(c.Z,{children:(0,n.jsx)(r.Suspense,{fallback:(0,n.jsx)("div",{children:"Loading..."}),children:(0,n.jsx)(el,{})})})}},12144:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var n=s(57437);s(2265);var r=s(27648),a=s(14938);function i(e){var t=e.items;return(0,n.jsxs)("nav",{className:"flex items-center text-sm mb-6 bg-gray-50 p-3 rounded-md",children:[(0,n.jsxs)(r.default,{href:"/",className:"flex items-center text-gray-600 hover:text-blue-600",children:[(0,n.jsx)(a.Z,{className:"h-4 w-4 mr-1"}),(0,n.jsx)("span",{children:"Home"})]}),t.map(function(e,s){return(0,n.jsx)("li",{children:s<t.length-1?(0,n.jsx)("button",{onClick:e.onClick,className:"hover:text-blue-600",children:e.label}):(0,n.jsx)("span",{className:"text-gray-500",children:e.label})},s)})]})}},93113:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var n=s(57437);s(2265);var r=s(12339),a=s(99376);function i(e){var t=e.children,s=(0,a.useRouter)(),i=(0,a.usePathname)();return(0,n.jsxs)("div",{className:"container mx-auto p-4 max-w-6xl",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Interview Management System"}),(0,n.jsx)(r.mQ,{defaultValue:(null==i?void 0:i.includes("/tests"))?"tests":(null==i?void 0:i.includes("/question-sets"))?"question-sets":"companies",className:"mb-8",onValueChange:function(e){switch(e){case"companies":s.push("/companies");break;case"tests":s.push("/tests");break;case"question-sets":s.push("/question-sets")}},children:(0,n.jsxs)(r.dr,{className:"grid w-full grid-cols-3 h-14 text-lg",children:[(0,n.jsx)(r.SP,{value:"companies",className:"py-3",children:"Companies"}),(0,n.jsx)(r.SP,{value:"tests",className:"py-3",children:"Tests"}),(0,n.jsx)(r.SP,{value:"question-sets",className:"py-3",children:"Question Sets"})]})}),(0,n.jsx)("main",{children:t})]})}},26110:function(e,t,s){"use strict";s.d(t,{$N:function(){return j},Be:function(){return g},Vq:function(){return u},cN:function(){return p},cZ:function(){return x},fK:function(){return f}});var n=s(5194),r=s(1780),a=s(46796),i=s(57437),c=s(2265),l=s(49027),o=s(32489),d=s(94508),u=l.fC;l.xz;var m=l.h_;l.x8;var h=c.forwardRef(function(e,t){var s=e.className,r=(0,a._)(e,["className"]);return(0,i.jsx)(l.aV,(0,n._)({ref:t,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s)},r))});h.displayName=l.aV.displayName;var x=c.forwardRef(function(e,t){var s=e.className,c=e.children,u=(0,a._)(e,["className","children"]);return(0,i.jsxs)(m,{children:[(0,i.jsx)(h,{}),(0,i.jsxs)(l.VY,(0,r._)((0,n._)({ref:t,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s)},u),{children:[c,(0,i.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,i.jsx)(o.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})});x.displayName=l.VY.displayName;var f=function(e){var t=e.className,s=(0,a._)(e,["className"]);return(0,i.jsx)("div",(0,n._)({className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t)},s))};f.displayName="DialogHeader";var p=function(e){var t=e.className,s=(0,a._)(e,["className"]);return(0,i.jsx)("div",(0,n._)({className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t)},s))};p.displayName="DialogFooter";var j=c.forwardRef(function(e,t){var s=e.className,r=(0,a._)(e,["className"]);return(0,i.jsx)(l.Dx,(0,n._)({ref:t,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",s)},r))});j.displayName=l.Dx.displayName;var g=c.forwardRef(function(e,t){var s=e.className,r=(0,a._)(e,["className"]);return(0,i.jsx)(l.dk,(0,n._)({ref:t,className:(0,d.cn)("text-sm text-muted-foreground",s)},r))});g.displayName=l.dk.displayName},73578:function(e,t,s){"use strict";s.d(t,{RM:function(){return d},SC:function(){return u},iA:function(){return l},pj:function(){return h},ss:function(){return m},xD:function(){return o}});var n=s(5194),r=s(46796),a=s(57437),i=s(2265),c=s(94508),l=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",(0,n._)({ref:t,className:(0,c.cn)("w-full caption-bottom text-sm",s)},i))})});l.displayName="Table";var o=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("thead",(0,n._)({ref:t,className:(0,c.cn)("[&_tr]:border-b",s)},i))});o.displayName="TableHeader";var d=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("tbody",(0,n._)({ref:t,className:(0,c.cn)("[&_tr:last-child]:border-0",s)},i))});d.displayName="TableBody",i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("tfoot",(0,n._)({ref:t,className:(0,c.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s)},i))}).displayName="TableFooter";var u=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("tr",(0,n._)({ref:t,className:(0,c.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s)},i))});u.displayName="TableRow";var m=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("th",(0,n._)({ref:t,className:(0,c.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s)},i))});m.displayName="TableHead";var h=i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("td",(0,n._)({ref:t,className:(0,c.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s)},i))});h.displayName="TableCell",i.forwardRef(function(e,t){var s=e.className,i=(0,r._)(e,["className"]);return(0,a.jsx)("caption",(0,n._)({ref:t,className:(0,c.cn)("mt-4 text-sm text-muted-foreground",s)},i))}).displayName="TableCaption"},46281:function(e,t,s){"use strict";s.d(t,{H:function(){return l},V:function(){return c}});var n=s(50059),r=s(57437),a=s(2265),i=s(280),c=(0,a.createContext)(null);function l(e){var t=e.children,s=(0,n._)((0,a.useState)(null),2),l=s[0],o=s[1],d=(0,n._)((0,a.useState)(!0),2),u=d[0],m=d[1];return(0,a.useEffect)(function(){i.OQ.auth.getSession().then(function(e){var t,s=e.data.session;o(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null),m(!1)});var e=i.OQ.auth.onAuthStateChange(function(e,t){var s;o(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null)}).data.subscription;return function(){return e.unsubscribe()}},[]),(0,r.jsx)(c.Provider,{value:{user:l,loading:u},children:t})}},76362:function(e,t,s){"use strict";s.d(t,{a:function(){return a}});var n=s(2265),r=s(46281),a=function(){var e=(0,n.useContext)(r.V);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},280:function(e,t,s){"use strict";s.d(t,{OQ:function(){return n}});var n=(0,s(93777).eI)("https://xwrjwvspbayowtwbrbcd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh3cmp3dnNwYmF5b3d0d2JyYmNkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDEzNDQ4OTksImV4cCI6MjA1NjkyMDg5OX0.mrgp3CeKu8eeoC0tRN_y-XpFgklVltYBqQYjY4HSIhQ")}},function(e){e.O(0,[9518,5457,5061,3513,4438,6008,7648,7827,4999,4074,1411,7737,4771,7611,2971,2117,1744],function(){return e(e.s=57837)}),_N_E=e.O()}]);