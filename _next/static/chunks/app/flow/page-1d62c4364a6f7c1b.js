(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[129],{90033:function(e,r,t){Promise.resolve().then(t.bind(t,27252))},27252:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return w}});var n=t(57437),a=t(2265),s=t(99376),i=t(93113),o=t(2403),c=t(50059),l=t(5853),u=t(280),d=t(62869),f=t(66070),m=t(14438),v=t(12144),h=t(76865),p=t(33245),x=t(32660),g=t(83229),N=t(76818),b=t(65613);function j(e){var r,t=e.companyId,i=(0,s.useRouter)(),j=(0,c._)((0,a.useState)(null),2),y=j[0],w=j[1],_=(0,c._)((0,a.useState)(!0),2),k=_[0],C=_[1],S=(0,c._)((0,a.useState)(!1),2),I=S[0],Z=S[1],O=(0,c._)((0,a.useState)(null),2),J=(O[0],O[1]),F=(0,c._)((0,a.useState)(""),2),R=F[0],z=F[1],M=(0,c._)((0,a.useState)(null),2),A=M[0],E=M[1],P=(0,c._)((0,a.useState)(!0),2),Y=P[0],D=P[1];(0,a.useEffect)(function(){function e(){return(e=(0,o._)(function(){var e,r,n,a,s,i,o,c;return(0,l.Jh)(this,function(l){switch(l.label){case 0:C(!0),l.label=1;case 1:return l.trys.push([1,7,8,9]),[4,u.OQ.from("companies").select("id, name").eq("id",t).single()];case 2:if(r=(e=l.sent()).data,n=e.error)throw n;return w(r),a="chatbot-flow-".concat(t,".json"),[4,u.OQ.storage.from("test-flows").download(a)];case 3:if(i=(s=l.sent()).data,!(!s.error&&i))return[3,5];return[4,i.text()];case 4:z(o=l.sent());try{J(JSON.parse(o)),D(!0)}catch(e){E("Invalid JSON format in flow file"),D(!1)}return[3,6];case 5:J(c={metadata:{version:"1.0.0",lastUpdated:new Date().toISOString(),company:r.name,description:"".concat(r.name," interview questions")},nodes:{root:{question:"Which area are you interested in exploring?",options:[]}},options:{}}),z(JSON.stringify(c,null,2)),D(!0),l.label=6;case 6:return[3,9];case 7:return console.error("Error fetching data:",l.sent()),E("Failed to load company or flow data"),m.Am.error("Failed to load data"),[3,9];case 8:return C(!1),[7];case 9:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[t]),(0,a.useEffect)(function(){try{JSON.parse(R),D(!0),E(null)}catch(e){D(!1),E("Invalid JSON format. Please fix before saving.")}},[R]);var Q=(r=(0,o._)(function(){var e,r,n,a;return(0,l.Jh)(this,function(s){switch(s.label){case 0:if(!y)return[2];if(!Y)return m.Am.error("Please fix the JSON errors before saving"),[2];Z(!0),s.label=1;case 1:var i;if(s.trys.push([1,3,4,5]),!((i=e=JSON.parse(R)).metadata&&i.nodes&&i.options?!!i.nodes.root||(E("Flow must include a root node"),!1):(E("Flow structure must include metadata, nodes, and options"),!1)))return Z(!1),[2];return e.metadata&&(e.metadata.lastUpdated=new Date().toISOString()),z(r=JSON.stringify(e,null,2)),n="chatbot-flow-".concat(t,".json"),[4,u.OQ.storage.from("test-flows").upload(n,new Blob([r],{type:"application/json"}),{upsert:!0})];case 2:if(a=s.sent().error)throw a;return m.Am.success("Flow saved successfully"),J(e),[3,5];case 3:return console.error("Error saving flow:",s.sent()),m.Am.error("Failed to save flow"),[3,5];case 4:return Z(!1),[7];case 5:return[2]}})}),function(){return r.apply(this,arguments)});return k?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Z,{items:[{label:"Companies",onClick:function(){return i.push("/companies?view=list")}},{label:"Loading..."}]}),(0,n.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,n.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary border-t-transparent"}),(0,n.jsx)("span",{className:"ml-2",children:"Loading..."})]})]}):y?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Z,{items:[{label:"Companies",onClick:function(){return i.push("/companies?view=list")}},{label:y.name,onClick:function(){return i.push("/tests?view=new&id=".concat(t))}},{label:"Manage Test Flow"}]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Manage Test Flow"}),(0,n.jsxs)("p",{className:"text-gray-500",children:["Configure the test structure and options for ",y.name]})]}),(0,n.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,n.jsxs)(f.Zb,{children:[(0,n.jsx)(f.Ol,{children:(0,n.jsx)(f.ll,{children:"Edit Flow JSON"})}),(0,n.jsxs)(f.aY,{children:[A&&(0,n.jsxs)(b.bZ,{variant:"destructive",className:"mb-4",children:[(0,n.jsx)(h.Z,{className:"h-4 w-4"}),(0,n.jsx)(b.Cd,{children:"JSON Error"}),(0,n.jsx)(b.X,{children:A})]}),(0,n.jsxs)(b.bZ,{className:"mb-4",children:[(0,n.jsx)(p.Z,{className:"h-4 w-4"}),(0,n.jsx)(b.Cd,{children:"Flow Structure"}),(0,n.jsxs)(b.X,{children:[(0,n.jsx)("p",{className:"text-sm",children:"The flow JSON defines the interview navigation structure and must include:"}),(0,n.jsxs)("ul",{className:"list-disc list-inside text-sm mt-2 space-y-1",children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("code",{className:"text-xs",children:"metadata"})," - version and company information"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("code",{className:"text-xs",children:"nodes"})," - including a root node and category nodes"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("code",{className:"text-xs",children:"options"})," - display text for each option"]})]})]})]}),(0,n.jsx)(N.g,{value:R,onChange:function(e){return z(e.target.value)},className:"font-mono text-sm h-[500px] ".concat(Y?"":"border-red-500")}),(0,n.jsxs)("div",{className:"flex justify-end mt-4",children:[(0,n.jsxs)(d.z,{variant:"outline",className:"mr-2",onClick:function(){return i.push("/companies?view=list")},children:[(0,n.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"Back"]}),(0,n.jsxs)(d.z,{onClick:Q,disabled:I||!Y,children:[(0,n.jsx)(g.Z,{className:"mr-2 h-4 w-4"}),I?"Saving...":"Save Flow"]})]})]})]})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Z,{items:[{label:"Companies",onClick:function(){return i.push("/companies?view=list")}},{label:"Company Not Found"}]}),(0,n.jsx)("div",{className:"text-center p-8",children:"Company not found"})]})}function y(){var e=(0,s.useSearchParams)().get("companyId");return e?(0,n.jsx)(j,{companyId:e}):(0,n.jsx)("div",{className:"p-4",children:"Company ID is required"})}function w(){return(0,n.jsx)(i.Z,{children:(0,n.jsx)(a.Suspense,{fallback:(0,n.jsx)("div",{className:"p-4 text-center",children:"Loading..."}),children:(0,n.jsx)(y,{})})})}},12144:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});var n=t(57437);function a(e){var r=e.items;return(0,n.jsx)("nav",{className:"flex items-center text-sm mb-6 bg-gray-50 p-3 rounded-md",children:r.map(function(e,t){return(0,n.jsx)("li",{children:t<r.length-1?(0,n.jsx)("button",{onClick:e.onClick,className:"hover:text-blue-600",children:e.label}):(0,n.jsx)("span",{className:"text-gray-500",children:e.label})},t)})})}t(2265)},93113:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var n=t(57437);t(2265);var a=t(99376);function s(e){var r=e.children;return(0,a.useRouter)(),(0,a.usePathname)(),(0,n.jsxs)("div",{className:"container mx-auto p-4 max-w-6xl",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Interview Management System"}),(0,n.jsx)("main",{children:r})]})}},65613:function(e,r,t){"use strict";t.d(r,{Cd:function(){return d},X:function(){return f},bZ:function(){return u}});var n=t(5194),a=t(46796),s=t(57437),i=t(2265),o=t(90535),c=t(94508),l=(0,o.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),u=i.forwardRef(function(e,r){var t=e.className,i=e.variant,o=(0,a._)(e,["className","variant"]);return(0,s.jsx)("div",(0,n._)({ref:r,role:"alert",className:(0,c.cn)(l({variant:i}),t)},o))});u.displayName="Alert";var d=i.forwardRef(function(e,r){var t=e.className,i=(0,a._)(e,["className"]);return(0,s.jsx)("h5",(0,n._)({ref:r,className:(0,c.cn)("mb-1 font-medium leading-none tracking-tight",t)},i))});d.displayName="AlertTitle";var f=i.forwardRef(function(e,r){var t=e.className,i=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:r,className:(0,c.cn)("text-sm [&_p]:leading-relaxed",t)},i))});f.displayName="AlertDescription"},62869:function(e,r,t){"use strict";t.d(r,{d:function(){return u},z:function(){return d}});var n=t(5194),a=t(46796),s=t(57437),i=t(2265),o=t(37053),c=t(90535),l=t(94508),u=(0,c.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=i.forwardRef(function(e,r){var t=e.className,i=e.variant,c=e.size,d=e.asChild,f=(0,a._)(e,["className","variant","size","asChild"]),m=void 0!==d&&d?o.g7:"button";return(0,s.jsx)(m,(0,n._)({className:(0,l.cn)(u({variant:i,size:c,className:t})),ref:r},f))});d.displayName="Button"},66070:function(e,r,t){"use strict";t.d(r,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return c},aY:function(){return f},eW:function(){return m},ll:function(){return u}});var n=t(5194),a=t(46796),s=t(57437),i=t(2265),o=t(94508),c=i.forwardRef(function(e,r){var t=e.className,i=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:r,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t)},i))});c.displayName="Card";var l=i.forwardRef(function(e,r){var t=e.className,i=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:r,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",t)},i))});l.displayName="CardHeader";var u=i.forwardRef(function(e,r){var t=e.className,i=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:r,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",t)},i))});u.displayName="CardTitle";var d=i.forwardRef(function(e,r){var t=e.className,i=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:r,className:(0,o.cn)("text-sm text-muted-foreground",t)},i))});d.displayName="CardDescription";var f=i.forwardRef(function(e,r){var t=e.className,i=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:r,className:(0,o.cn)("p-6 pt-0",t)},i))});f.displayName="CardContent";var m=i.forwardRef(function(e,r){var t=e.className,i=(0,a._)(e,["className"]);return(0,s.jsx)("div",(0,n._)({ref:r,className:(0,o.cn)("flex items-center p-6 pt-0",t)},i))});m.displayName="CardFooter"},76818:function(e,r,t){"use strict";t.d(r,{g:function(){return c}});var n=t(5194),a=t(46796),s=t(57437),i=t(2265),o=t(94508),c=i.forwardRef(function(e,r){var t=e.className,i=(0,a._)(e,["className"]);return(0,s.jsx)("textarea",(0,n._)({className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r},i))});c.displayName="Textarea"},280:function(e,r,t){"use strict";t.d(r,{OQ:function(){return n}});var n=(0,t(93777).eI)("https://xwrjwvspbayowtwbrbcd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh3cmp3dnNwYmF5b3d0d2JyYmNkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDEzNDQ4OTksImV4cCI6MjA1NjkyMDg5OX0.mrgp3CeKu8eeoC0tRN_y-XpFgklVltYBqQYjY4HSIhQ")},94508:function(e,r,t){"use strict";t.d(r,{cn:function(){return s}});var n=t(61994),a=t(53335);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.m6)((0,n.W)(r))}},32660:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var n=(0,t(79205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},33245:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var n=(0,t(79205).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},83229:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var n=(0,t(79205).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},76865:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var n=(0,t(79205).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},99376:function(e,r,t){"use strict";var n=t(35475);t.o(n,"usePathname")&&t.d(r,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(r,{useRouter:function(){return n.useRouter}}),t.o(n,"useSearchParams")&&t.d(r,{useSearchParams:function(){return n.useSearchParams}})}},function(e){e.O(0,[569,457,438,971,117,744],function(){return e(e.s=90033)}),_N_E=e.O()}]);